History of 2.0b6ma1 -- changes since 2.0b6:

* compile tested on:
  - SuSE Linux 7.0 i386
  - FreeBSD 4.0 i386
  - Solaris 2.7 USparc (throws warnings for signal, harmless)

Merged with 2.0b5_ma7Ω current.
Most notable changes:

	* messy ChangeLog
	* AUTHORS now has the names that were at the top of the source
	  files
	* cleaned up Makefile a lot, changed mode 4755 to 4750
	  * no longer takes over ownership of files/dirs already present
	    (reported for former version by Johannes Teveﬂen)
	  * allows configuring and building outside of source tree
 	    (useful if compiling multiple architectures at once)
	  * proper man path handling
	  * more compact handling (switched to rules)
	  * add some .PHONY directives
	  * move GZIP path into config.c
	  * no longer needs makedepend (but needs gcc now)
	  * much more compact install/uninstall sections
	* Formatted README.html properly (now weblint-proof)
	  * proper section nesting
	  * removed spurious leading white space
	* Add to TODO
	* Reintroduce 1.9.17ma3/2.0b5_ma7-getline/getaline
	* Fix ln_log.c to handle %m (only in this form!)
	* switch logging to ln_log, reduces code size and enhances
	  maintainability
	* attributes.h to encapsulate __attributes__ GCC extension
	* remove config.c from distribution, autogenerated by Makefile
	* b_sortnl.c as ultra-short non-locale-dependent sort
	  replacement lest sort breaks space collation
	* switch config parsing to bsearch (uses b_sortnl)
	* config.table enhances maintainability and gives shorter code
	* configparam.[ch]: new, parse config parameters
	* configure{,.in}: go search bzip2 as well, check UID_T, fix
	  socklen_t check for FreeBSD 4, fix spooldir/confdir/lockfile,
	  add -lcrypt only to CRYPTLIB, fix PCRE autodetection
	* split critmem
	* dirutil: open_dir variants for common directories
	* fetchnews: reintroduce STAT
	* replace some sscanf by the more efficient and smaller get_long
	* fix some debug mode tampering
	* str_ulong: fast formatter (to replace printf crap)
	* h_error.[ch]: proper logging of gethost* error conditions
	* move BLOCKSIZE to leafnode.h
	* fix leafnode.spec.in and RPM building (unlike 1.9.17_ma, this
	  requires root permissions for chown, cannot be fixed with
	  reasonable effort without automake)
	* ln_log.c: new logging wrapper, like syslog, but with more
	  output options (can log %m to stderr) and EMERG/ALERT/CRIT
	  removed.
	* makedepend.sh: new (XFree86 4.x makedepend gave headaches)
	  requires gcc
	* junked makerpm.sh
	* miscutil: make table of directories
	* switch uid/gid handling to ugid library
	* nntpd.c: handle POST without body
	* speed up xoverinfo handling
	* don't use printf on constant strings
	* fix sprintf in Message-ID recommendation
	* nntputil.c: split h_strerror again (it's INTENTIONALLY
	  separate)
	* fix some minor memory leaks (tempfilename etc.)

History of 2.0b6 -- changes since 2.0b5:

General comments:
================

221200: everything except Makefile.in and the various templates for
	manpages is now functionally identical to leafnode-2.0b5_ma6.
221200: replaced all TODOs with FIXMEs.
221200: miscutil.c, nntpd.c, nntputil.c, rnews.c, texpire.c and xoverutil.c
	are now functionally identical to leafnode-2.0b5_ma6.
151200: filterutil.c and localutil.c are now functionally identical to
	leafnode-2.0b5_ma6.
271100: checkgroups.c, config.c, configutil.c and fetchnews.c are now
	functionally identical to leafnode-2.0b5_ma6.
241100: activutil.c, applyfilter.c and artutil.c are now functionally
	identical to leafnode-2.0b5_ma6.
241100: syslog( ..., "%m" ) is proper logging according to "Advanced
	Programming in the UNIX environment", p.422:
	  The format argument, and any remaining arguments, are passed to
	  the vsprintf function for formatting. Any occurrence of the two
	  characters %m in the format are first replaced with the error
	  message string (strerror) corresponding to the value of errno.

applyfilter:
===========

221200: main(): the reply of readconfig() is now stored in i instead of
	n because it is signed.
241100: main(): if called with options, program would terminate with
	usage message. Patch by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de>.

fetchnews:
=========

221200: testheaderbody(): argument is now int instead of char.
211200: main(): if timeout_active is expired, the active file is not
	read any more. Only this leads to the removal of deleted
	groups. Problem described by Ulf Herbers <ulf@herbers-schramm.de>.
191200: do_server() now has an additional parameter "newsgroup" which
	should it make possible in the future to evaluate the -N option
	(which doesn't work yet).
291100: postarticles(): an open article file was not closed under
	certain circumnstances. Bug found by Carl D. Craven
	<raven@phoenyx.net>.
271100: checkactive(): casted time_t differences to long before syslog()ging
	them. Patch by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
271100: getgroup() has to consider the new return values for doxhdr() or
	doxover(). At the moment, no special action is implemented if
	-2 is returned instead of -1.
271100: doxhdr() now also returns -1 for error, -2 if XHDR was rejected.
271100: doxover() now returns -1 for error, -2 if XOVER was rejected.
	Suggested by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
271100: "throttling" is used as a parameter for sleep() which prefers
	unsigned int. Fixed by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de>.
271100: getarticles(): Variables sent, recd, window have also to be signed.
	Fixed by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
271100: Since "n" in getarticles() is signed, the values it is compared
	with should be also signed. Therefore, "windowsize" is now signed
	as well. Fixed by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
271100: getarticles(): since "outstanding" is not unsigned, the parameter
	"n" should not be unsigned either. Fixed by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de>.
271100: getgroup(): since "outstanding" can assume -1, it should not be
	unsigned. Fixed by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
271100: getmarked(): second parameter of truncate() now casted to off_t.
	Patch by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
271100: getmarked(): improved error logging if file in "interesting.groups"
	could not be read or written. Suggested by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de>.
271100: delposted(): now deleting posted articles using full pathnames.
	Suggested by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
271100: getgroup(): implemented "usexhdr" after a suggestion by Matthias
	Andree <ma@dt.e-technik.uni-dortmund.de>.
261100: getfirstlast(): if using "fetchnews -x" and the number being
	higher than the high water mark on the upstream server, integer
	underflows could happen. Bugs fixed by Stefan Wiens <s.wi@gmx.net>.
241100: getgroup(): if outstanding() returns 0, the last article will
	be considered again in the next fetchnews run. Bug fixed by
	Stefan Wiens <s.wi@gmx.net>.
241100: main(): since locking is done based on fcntl() (and the
	lockfile left open during the process), the lockfile
	should not be unlinked. Just closing it will release the lock.
241100: main(): moved writeactive() into the main process. This
	simplifies the locking scheme considerably.
141100: doxover() crashed if XOVER lines were truncated, e.g. on
        "... de." because strchr(p,':') returned a NULL pointer
	which then was attempted to modify. Fixed.

libutil:
=======

221200: nntputil: nntpconnect(): various changes by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de> to provide more instructive
	error messages.
221200: nntputil: nntpconnect(): shutdown nntpin as well as nntpout.
	Patch by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
221200: nntputil: nntpconnect(): patch by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de> to provide for proper handling
	of failed dup().
221200: miscutil: getaline(), critmalloc() and critrealloc() moved into
	separate files which makes it easier to test them. Done first
	by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
221200: miscutil: copyfile(): "toread" and "read" declared as "size_t"
	instead of "long". Done first by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de>.
221200: miscutil: fqdn string size now defined via #define as FQDN_SIZE.
	Done first by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
221200: miscutil: removed "#define LM_SIZE" because the defined constant
	was not used anyway. Done first by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de>.
221200: miscutil: GNU getline() not used anymore since it chokes on
	"strings" not ending with either NUL, CR or LF. Verified with
	Matthias Andree's <ma@dt.e-technik.uni-dortmund.de> getaline
	test suite from leafnode-1.9.17ma3.
221200: miscutil: getaline() reverted to the 1.9.16 version which chops
	off things after a NUL byte. This version ignores single NUL
	bytes to be read, but this is irrelevant for reading NNTP
	traffic or textfiles.
221200: activutil: writeactive(): count now size_t instead of int.
221200: activutil: helpfindgroup() now uses size_t instead of long for
	low, high and mid.
221200: miscutil: parseopt()s second argument is now int instead of char.
	Triggered by playing around with the -Wconversion flag of gcc.
211200: added a mkstemp.c file written by myself. This replaces the
	insecure call to mktemp() in xoverutil.c which would occur if
	./configure could not find mkstemp(). The new mkstemp() is
	reasonably secure but not bullet-proof (it will not retry to
	open a file under a different name which is stoopid).
151200: localutil: moved "local.groups" file from /var/spool/news/leaf.node
	(i.e. a subdirectory of SPOOLDIR) to /etc/leafnode (i.e.  LIBDIR)
	because it is a configuration file that has to be edited from
	hand, not something written by leafnode.
151200: filterutil: cast the result of strlen() in the pcre_exec() call
	to int. Suggested by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
271100: localutil: empty lines would lead to strange things when doing
	LIST. Fixed. Reported by Joerg Dietrich <joerg@dietrich.net>.
271100: configutil: readconfig(): implemented "usexhdr" after a suggestion
	by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
271100: miscutil: initvars() now unconditionally loses its privileges.
	Correct output in case of errors is directed by isatty().
	Suggested by Stefan Wiens <s.wi@gmx.net>.
261100: miscutil: if a program that is installed suid root (e.g. fetchnews,
	texpire) shall reliably drop its privileges, the parameter given
	to initvars() cannot be argv[0] because this could possibly be
	overwritten by a malicious user. Therefore we use string constants
	now. Problem reported by Stefan Wiens <s.wi@gmx.net>.
241100: artutil: fgetheader(): "hlen" now defined as size_t instead of
	long. Suggested by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
241100: artutil: mgetheader(): some casting from "long" to "size_t".
	Suggested by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
241100: activutil: fakeactive(): switched format string to "long unsigned"
	in debuglog. Patch by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de>.
241100: activutil: readactive(): "bufsize" now defined as size_t instead
	of long. This results in a lot of casting. Suggested by Matthias
	Andree <ma@dt.e-technik.uni-dortmund.de>. IMO all these various
	prototypes (size_t, off_t, ...) for "long" really suck. 
241100: activutil: helpwriteactive(): switched "mid" back to "long"
	instead of "unsigned long". Suggested by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de>.
241100: activutil: writeactive(): "c" now statically allocated. Suggested
	by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
241100: activutil: mergegroups(): "count" now defined as size_t instead
	of int.
241100: activutil: "activesize" now defined as size_t instead of int.
	Patch by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
241100: miscutil: removed double inclusion of fcntl.h
201100: localutil: islocal() would sometimes free a pointer which was
	not allocated. Fixed.

nntpd:
=====

020101: dogroup(): inserted omitted closedir().
020101: dogroup(): when counting the contents of a directory, the .overview
	file was always counted as well
020101: dogroup(): if a group is empty, return "211 0 0 0" instead of
	"211 0 number number".
020101: dolistgroup(): if a group has already been marked as "interesting"
	but is empty, dolistgroup() does not return article numbers.
020101: switched of debug logging in fprintpseudobody()
221200: replaced the whole untested IPV6 code in main() with a patch by
	Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
221200: fopenart(): somebody had requested to have a pseudoarticle in
	local groups as well. It turns out that this is quite inconvenient,
	therefore this has been removed again (can't see when it was
	introduced).
221200: fopenpseudoart(): for some reason the article number was
	"unsigned long long" instead of "unsigned long". Fixed by
	Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
241100: replaced all occurrences of "syslog(..., "%s", strerror(errno))"
	with "syslog(..., "%m")".
241100: when posting, the child process now closes stdin, stdout and
	stderr. This lets inetd close the connection if the parent
	process dies. Patch by Stefan Wiens <s.wi@gmx.net>.
201100: new function ismoderated() returns first moderated newsgroup
	name in a Newsgroups: line. Modelled after islocal().
161100: parser(): timeout was quit with 421 which slrn did not like.
	No leafnode closes the connection with 400. Bug reported by
	Karsten Petersen <karsten.petersen@informatik.tu-chemnitz.de>.
311000: dopost(): now recommends a Message-ID.
311000: dopost(): checks for duplicates. Suggested by Stefan Wiens
	<s.wi@gmx.net>. Became necessary because the new nntpd stores
	postings locally.
301000: gmtoff() returned wrong values. Bug discovered and fixed by
	Stefan Wiens <s.wi@gmx.net>.

texpire:
=======

221200: dogroup(): various castings introduced with a patch by Matthias
	Andree <ma@dt.e-technik.uni-dortmund.de>.
271100: dogroup(): inserted a bug on 241100: an unsigned int cannot
	become < 0; therefore it makes no sense to write
	unsigned int a;
	for ( a=some_value; a >= 0; a--) { ... }
	Pointed out by Joerg Dietrich <joerg@dietrich.net>.
241100: savethread() rewritten by Stefan Wiens <s.wi@gmx.net> because
	it did not check the last References: entry.
241100: if an .overview file contained more entries than files are
	present in the corresponding directory (i.e. current became
	> acount), interesting things could happen. It is not clear
	from looking at the code whether this could occur. Fixed by
	Stefan Wiens <s.wi@gmx.net>.
221100: repaired threading (hopefully) by marking all articles as
	killed before the actual cycling for rescue starts. The bug
	was introduced into 2.0a15 on 210800. Noted by Joerg Dietrich
	<joerg@dietrich.net>.

Miscellaneous:
=============

020101: repaired formatting of the man pages.
020101: made man pages subject to formatting by configure, as exemplified
	by Matthias Andree <ma@dt.e-technik.uni-dortmund.de> in
	leafnode-2.0b5_ma7.
020101: fiddled around with Makefile.in to make it functionally identical
	with leafnode-2.0b5_ma7.
171200: configure.in: socklen_t may not be defined in
	/usr/include/sys/socket.h ; therefore included a typedef
	statement in leafnode.h dependent on a new test in configure.in.
	Problem reported by Kaspar Klingholz <kp@balu.klingholz.de>.
111200: configure.in: removed wildcard rule for *.c -> *.o conversion
	implemented on 291100 because it works only with GNU make.
081200: configure.in/Makefile.in: gzip replaced with a search for
	gzip; suggested by Bruno Rohee <rohee@OpenBSD.ORG>. It's yet
	unclear what we do if we can't find it :-)
011200: Makefile.in: when uninstalling, testing for $PCRELIB did not
	work if a dynamically linked pcrelib existed. Now pcre.7 is
	unconditionally removed. Bug reported by Stephane Boffin
	<sboffin@nertec.com>.
011200: Makefile.in: when uninstalling, the variable $INSTALLROOT was
	incorrectly declared. Bug reported by Stephane Boffin
	<sboffin@nertec.com>.
291100: Makefile.in: replaced the various rules for *.o files with a
	single one. However, it is not clear whether this single rule
	will work with non-GNU make.
291100: added additional "-W" flag for compilation in configure.in
271100: added Theo de Raadt's copyright to the README.
271100: added Rich Salz's copyright to the README.
271100: fixed leafnode.8 to include new "usexhdr" variable.
241100: fiddled with configure.in following ideas by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de>.
241100: version is now defined in configure.in so that the Makefile.in
	doesn't have to be touched (ideally).
241100: Makefile.in: changed the VPATH declaration to include the
	current directory. (I have actually no idea why one would need
	this variable :-)
161100: Makefile.in: "install:" rule now also depends on a compiled rnews
301000: Makefile.in: changed the "dist:" rule to make use of the new
	stuff described in the next paragraph.
301000: Makefile.in: added some stuff from the autoconf documentation
	which will cause automagic autoheader/autoconf if one of the
	relevant files is changed. Patch by Matthias Andree
	<ma@dt.e-technik.uni-dortmund.de>.

----------------------------------------------------------------------------

To our all-time favourite emacs: this is -*-outline-*- mode.

* History of 2.0

Note leafnode 2.0 is not yet released. These are pre-beta tests.

** History of 2.0b5_ma8 -- changes since 2.0b5_ma7:

- install newsq setgid news to be able to protect leafnode's spooldir.

- remove some debug=0 and debug=debugmode-occurrences. suppressing
  information is no good for debugging.

- junk delposted entirely. No traces left. 

- when posting, try STAT before HEAD (less overhead in case the article
  is already there)
  
- forward port of "files left open" bug fix from 1.9.18 (reported by
  Carl D. Cravens, fixed by Cornelius Krasel)

- NEWNEWS command uses .overview for speed (good for high-traffic
  groups)

- new internal function cuttab, which breaks a field out of a
  tab-separated string and returns a copy (VERY useful for .overview
  handling). The string returned must be free(3)d.

- fix broken -P option (checkforpostings expected all-numeric file
  names, while leafnode's spool files also have two "-" characters in them)
  (Reported by Raymond Scholz) 

- groupexpire fixed, NOTE: NEW SYNTAX groupexpire=de.rec.fotografie 10
  (Reported by Raymond Scholz) Also note that the old 2.0b5 parser could
  crash on bogus data in config file here.

** History of 2.0b5_ma7 -- changes since 2.0b5_ma6:

- portability workaround for broken Solaris /bin/sh: 
  replace test -e by test -f; note that SUSv2 requires test -e
  (reported by Johannes Teveﬂen)

- link own libraries before system libraries

- fix Makefile to heed CFLAGS, CPPFLAGS and LDFLAGS properly (as per
  autoconf and make documentation)

- merge libugid.a into liblnutil.a

- Makefile cleanups

- fix installation procedure, no longer takes over existing directories
  except its spool directory (reported by Johannes Teveﬂen)

- fix broken make clean if pcre missing (reported by Johannes Teveﬂen)

- fix link count type in artutil.c:281, explicit cast to long.
 
- ln_log now has ln_log_so which logs to syslog and stdout

- nntpd now redirects stderr to /dev/null to prevent initialization
  errors from being sent to the client

- nntpd now logs unknown options at WARNING level (was NOTICE)

- fix broken @VERSION@ in texpire.8.in

** History of 2.0b5_ma6 -- changes since 2.0b5_ma5:

NOTE that the new locking scheme is not in place yet.

- provide replacement for sprintf(buf,"%lu",something): str_ulong

- provide replacement for inet_ntop (uses inet_ntoa)
  note that compiling --with-ipv6 will fail in that case.

- Makefile fix: don't append {0,0} in configparam_data.c, should fix
  configparam related crashes (reported by Stefan Fleiter)

- remove spurious free(c) in activutil.c:215 which caused crashes after
  activutil was done. (reported by Michael Mauch)

- change if(optind+1<argc) to >argc in applyfilter.c:75 which caused
  immediate segfault when called without newsgroup (reported by
  Michael Mauch)

  NOTE that applyfilter currently only deals with one newsgroup per invocation!

- fix all numeric constants around fqdn to FQDN_SIZE

- fix some explicit ==/!= 0/NULL checks

- merge "xover error: Message ID does not end with >" in one if branch

- fix some printf to ln_log

- log unknown configuration parameters

** History of 2.0b5_ma5 -- changes since 2.0b5_ma4:

NOTE that the new locking scheme is not in place yet.

- squash all whitespace on the inner side of parentheses.

- remove gperf dependency, not portable enough. as replacement, now
  use qsort and bsearch. New file config.table, requires awk at build
  time to generate configparam_data.c and config_defs.h. New configparam.c.

- make dist builds bzip2 without PCRE

- various logging consistency fixes, remove excess LF in some ln_log files.

- remove some if(verbose > XX) in favor of ln_log.

- minor Makefile fixes to reduce rebuilding of components already built

- new b_sortnl.c (build-time utility to overcome sort LC_COLLATE
  madness, AT&T's Graphviz was trapped by that one)

- new h_error.h and .c to give symbolic output of gethostbyname h_errno.

- improved error checking in nntpconnect (check for dup and
  gethostbyname failures)

** History of 2.0b5_ma4 -- changes since 2.0b5_ma3:

- Fixes to IPv6 in nntpd.c -- PLEASE CHECK

- Further fixes to console logging (leftover %m formats)

- Fix local.groups handling

** History of 2.0b5_ma3 -- changes since 2.0b5_ma2:

- Now has a new configuration file switch named avoidxover, if that is
  non-zero, then prefer XHDR over XOVER (only possible if not delaying
  bodies and not filtering).

- Reintroduce XOVER, make preferring XOVER over XHDR the default. INN is
  DEAD slow on XHDR, and INN is in widespread use.

- No longer uses syslog directly (avoids excess printf statements), but
  has a all-in-one-log-to-syslog-and-console function. system
  dependencies encapsulated in separate file.

- miscutil.c: bugfix, drops root privileges BEFORE making
  directories. Now makes all needed directories. (Removed from Makefile).

- Bugfixes with unsigned long wrapping in fetchnews.c, which would then
  fetch the world on the second invokation. Also recognizes "no new
  news" again. Fixes to off-by-one errors.

- SECURITY bugfixes in rnews.c. (was vulnerable against all kinds of
  /tmp races, now uses mkstemp).

- Add some missing strerror(errno) to logging.

Maintainer only: Now uses gperf to speed up parsing, currently only for 
221200: processfile(): Matthias Andree <ma@dt.e-technik.uni-dortmund.de>
	fixed format string of first fprintf() statement.
221200: makecompressedfile() now uses mkstemp() instead of tmpnam().
	Patch by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
221200: processbatch() now uses mkstemp() instead of tmpnam(). Patch by
	Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
221200: rnews now learns the location of "gzip" from the Makefile.
config file.

** History of 2.0b5_ma2 -- changes since 2.0b5-ma1:

NOTE: This version changes the dash in -ma1 to an underscore in _ma2 for
----- RPM compatibility.

Compiling on FreeBSD 4.0, I found some problems in syslog calls. Not
sure if they are security relevant, you'd better update.

Makefile.in:
============
20001112: Add support for separate critmem and getline/getaline
	  compilation. Remove unnecessary object file rules, replacing
	  them by a .c.o: rule. Fix missing rnews dependency in install.
	  Work around broken directory handling in dist. Move VERSION to
	  configure.in to allow replacement in leafnode.spec.in. Take
	  RPMSRC from configure. Introduce HDRFILES for proper
	  dist. Change rpm target.

acconfig.h:
===========
20001112: Add HAVE_GETLINE. 

activutil.c:
============
20001112: Fix broken syslog formats.
20001113: Change various variables to size_t. Change mid in helpfindgroup to
	  signed.

applyfilter.c:
==============
20001113: Introduce err, don't abuse n for errno (signedness issue)

artutil.c:
==========
20001113: Change various variables to size_t.

configure.in:
=============
20001112: Add support to replace getline. Add VERSION. Add leafnode.spec
	  to AC_OUTPUT. Fix detecting when lynx is not there.
 
configutil.c:
=============
20001112: Fix broken syslog formats.

critmem.c:
critmem.h:
==========
20001113: Forward port from 1.9.17ma3

fetchnews.c:
=============
20001112: Fix broken syslog formats.
20001113: Fix various signedness issues.

filterutil.c:
=============
20001113: Cast strlen to int in pcre_exec to match prototypes.

getaline.c:
getline.c:
==========
20001113: Forward port from 1.9.17ma3

leafnode.h:
===========
20001112: Move crit{m,re}alloc to critmem.h, include that file. 
	  Add prototype for getline.
20001113: Provide BLOCKSIZE. Fix prototype for insertmsgid, arg 2 to
	  unsigned long.

leafnode.spec.in:
=================
20001113: Forward port from 1.9.17ma3

localutil.c:
============
20001113: Fix broken isspace() detection for characters > 127 by changing 
	  l and p to unsigned char *. Fix casts to int.

miscutil.c:
===========
20001113: Remove BLOCKSIZE, now in leafnode.h. Cast modes to
	  mode_t. Remove crit{m,re}alloc. Fix insertmsgid
	  prototype. Remove getaline, now in own file. Fix types in
	  copyfile to size_t.

nntpd.c:
========
20001112: Fix long long to long. Change socklen_t to size_t, socklen_t
	  is not supported by Linux' libc5 (tried on SuSE 5.3).
20001113: Fix various types to size_t.

rnews.c:
========
20001112: Add "FIXME" comments to tmpnam.
20001113: Remove BLOCKSIZE, now in leafnode.h. Fix type of i to size_t.

texpire.c:
==========
20001112: Cast st.st_size to size_t. 

xoverutil.c:
============
20001113: Code reformatting for readibility. Cast st.st_size to size_t.

** History of 2.0b5-ma1 -- changes since 2.0b5:

2.0b5-ma1 is a resynchronization release.

ChangeLog:
==========
20001112: Add some lines to make it an Emacs Outline document. Merge
          typo diffs Cornelius omitted in 2.0b4 (casted->cast). Switch
          to ISO-8601 compact date format. Switch to 4-digit year.

Makefile.in:
============
20001112: Bump VERSION to 2.0b5-ma1. Add LINKPCRELIB and CRYPTLIB to cut
          down library dependencies. Fix inconsistent *DIR. Add support
	  for get* functions. Remove excess MFLAGS/MAKEFLAGS. Fix clean,
	  realclean and distclean. Add automatic remaking target omitted
	  from 2.0b4.

applyfilter.c:
==============
20001112: Change c[] array size to auto in main. Comment out global
	  variable "verbose".

config.h.in:
============
20001112: Remove HAVE_FNMATCH, HAVE_LIBCRYPT, HAVE_LIBPCRE, they are
	  now handled implicitly.

configure:
==========
20001112: Add --with-spooldir, --sysconfdir default /etc/leafnode, 
	  --with-lockfile. Enhance PCRE and libcrypt detection. Support
	  retrieving RPM build dirs. Remove AC_FUNC_FNMATCH.

fetchnews.c:
============
20001112: Minor cleanups. Replace sscanf by get_long. Remove explicit
	  "!= NULL" checks (bad style). Change n to long in getfirstlast.

leafnode.h:
===========
20001112: Include "get.h"

localutil.c:
============
20001112: Remove explicit == FALSE comparison.

miscutil.c:
===========
20001112: Add comment warning NOT to define ABORT to 1. Fix explicit !=
	  FALSE comparison.

nntpd.c:
========
20001112: Fix explicit == FALSE comparison. Change salt initializer.

rnews.c:
========
20001112: Make parsing #! rnews lines more robust. Add more verbose
	  error messages.

xoverutil.c:
============
20001112: Work around non-const writev prototypes (strcpy lineend,"\n")

** History of 2.0b5 -- changes since 2.0b4:

fetchnews:
=========

20001030: doxover(): when returned XOVER lines were truncated because of
	  very long References: section, a segfault was the result. Now
	  doxover() generates a truncated pseudo-header without any
	  Lines: and Bytes: entries.
20001030: doxover(): now killfilter() is applied before stat()ing the
	  message id. This should speed up the program.
20001030: newsgroups are only written into /var/spool/news/leaf.node/ser.ver.name
	  if indeed present on that server.

libutil:
=======

20001030: configutil: "filtermode" was set to FM_HEAD & FM_XOVER which was
	  0. Set to FM_HEAD | FM_XOVER which equals FM_BOTH.

Miscellaneous:
=============

20001029: configure.in looks for lynx to generate README
20001029: "make dist" automatically generates a new README from README.html
	  if lynx is found
20001029: removed obsolete German and Catalan documentation.

----------------------------------------------------------------------------

** History of 2.0b4 -- changes since 2.0b3:

applyfilter:
===========

20001029: the char constant -\|/ is now declared "const". Patch by
	  Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
20001029: made "n" unsigned long. Suggested by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.

fetchnews:
=========

20001029: main(): msgid declared as "static" which removes the obnoxious
	  warning about it being affected by longjmp().
20001029: doxover() and doxhdr(): converted a few "unsigned char *" into
	  "char *". Suggested by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
20001029: made global variable "windowsize" unsigned long. Suggested by
	  Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
20001029: doxhdr: removed unnecessary parameter "groupname" from declaration.
	  Suggested by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.

libutil:
=======

20001029: xoverutil: writexover(): new variable lineend to bring constant
	  "\n" into header. Suggested by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
20001029: miscutil: error logging in critmalloc()/critrealloc() is now
	  done with long instead of int. Patch by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
20001029: miscutil: did casting of malloc()/realloc() return values in
	  critmalloc()/critrealloc(), respectively. Patch by Matthias
	  Andree <ma@dt.e-technik.uni-dortmund.de>.
20001029: activutil: readactive(): return value of memchr() is now casted.
	  Patch by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
20001029: activutil: helpfindgroup() could return -1 and therefore should
	  not be declared "unsigned". Patch by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
20001029: xoverutil: return value of findxover() now long int instead of int.
	  Suggested by Joerg Dietrich <joerg@dietrich.net>.
20001029: xoverutil: parameter to findxover() now declared as unsigned long
	  instead of int.
20001029: filterutil: killfilter(): removed unnecessary parameter "artno".
	  Suggested by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
20001029: artutil: modified call of store() by removing all unnecessary
	  parameters. Suggested by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
20001027: xoverutil: helpfindxover() would segfault under certain
	  circumstances if the calculation of "new" yielded 0. Bug
	  fixed by Joerg Dietrich <joerg@dietrich.net>.

nntpd:
=====

20001029: global variable "cmd" declared "static". Suggested by Matthias
	  Andree <ma@dt.e-technik.uni-dortmund.de>.
20001029: dolistgroup(): declared art as unsigned long instead of int.
	  Suggested by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
20001029: doxover(): declared art, a, b as unsigned long instead of int.
	  Suggested by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
20001029: doselectedheader(): declared a, b and c as unsigned long instead
	  of int. Suggested by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.

General:
=======

20001029: renamed all variables called "new" to something else. This makes
	  it possible to compile leafnode with g++ which does much stricter
	  type-checking than gcc. Suggested by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.

----------------------------------------------------------------------------

** History of 2.0b3 -- changes since 2.0b2:

fetchnews:
=========

20001027: yesterday we did a number of "if ( port == 119)" constructs.
	  Only today we realized that, if the default port is used,
	  "port" is set to zero. Made the proper changes.
20001026: made several changes to accommodate retrieving news from the
	  same server on different ports. Unfortunately I have no idea
	  any more who sent me the patch.
20001026: nntpactive(): To avoid a compiler warning, we let strftime()
	  produce a four-digit year; in the next line, we skip the
	  first two digits, though. Code written by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
20001026: doxover(): the generated pseudoheader now also contains a
	  Bytes: header. Patch by Joerg Dietrich <joerg@dietrich.net>.
20001026: getarticle(): killfilter() was employed regardless of the
	  filtermode. Bug spotted by Joerg Dietrich <joerg@dietrich.net>.

libutil:
=======

20001027: artutil.c: store() didn't initialize the static variable cg
	  which might have resulted in a core dump. Fixed. Problem
	  reported by Stefan Fleiter <stefan.fleiter@gmx.de>.
20001027: made strdup.c a separate file. Unfortunately it doesn't compile
	  at all, and I don't know why.
20001027: added a vsnprintf() by Theo de Raadt with BSD license that
	  also contains snprintf(). Therefore I removed both the
	  snprintf() and vsnprintf() from miscutil.c. This fixes the
	  problem outlined below.
20001026: artutil: storearticle() did not honour "create_all_links". Patch
	  by Joerg Dietrich <joerg@dietrich.net>.
20001026: configutil: filtermode now set by default to (FM_XOVER & FM_HEAD) .
20001025: miscutil: inserted a very crude replacement for vsnprintf()
	  using vsprintf() to make Leafnode compile on OSF1. It is clear
	  that vsprintf() is prone to buffer overflow attacks.

nntpd:
=====

20001026: fopenart(): if a local group is visited, no pseudoarticle is
	  present. Suggested by Joerg Dietrich <joerg@dietrich.net>.
20001025: did not compile with IPV6 because the logging of connections
	  always assumed IPV4 addresses. Error reported by Mark Brown
	  <broonie@sirena.org.uk>. Very crude fix by omitting any
	  reporting if compiled with IPV6.

rnews:
=====

20001026: rnews didn't know local groups. Patch by Joerg Dietrich
	  <joerg@dietrich.net>.

Miscellaneous:
=============

20001026: leafnode.h: included <sys/types.h> to account for "size_t".
	  Suggested by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
20001026: removed miscellaneous references to COPYING. Noted first by
	  Phil Hunt <philh@comuno.freeserve.co.uk>.
20001025: leafnode.h: added vsnprintf() prototype
20001025: leafnode.h: size_t may only occur in a file after stdio.h has
	  been included, otherwise gcc on OSF1 will barf. Error reported
	  by Joerg Dietrich <joerg@dietrich.net>.

----------------------------------------------------------------------------

** History of 2.0b2 -- changes since 2.0b1:

libutil:
=======

20001025: xoverutil: gfixxover(): argument of isspace() was not cast
	  to unsigned char. Reported by Joerg Dietrich <joerg@dietrich.net>.
20001025: miscutil: snprintf(): unused variable rval was present.
	  Reported by Joerg Dietrich <joerg@dietrich.net>.
20001025: artutil: mgetheader(): argument of isspace() was not cast to
	  unsigned char; instead the result of isspace() was cast. Bug
	  reported by Joerg Dietrich <joerg@dietrich.net>.

nntpd:
=====
20001025: list(): argument of tolower() was not cast to unsigned char.
	  Reported by Joerg Dietrich <joerg@dietrich.net>.

Miscellaneous:
=============

20001025: leafnode.h: added a declaration of snprintf() for systems
	  which don't provide is (snprintf() is defined in miscutil.c).
	  Bug reported by Joerg Dietrich <joerg@dietrich.net>.
20001025: README: added a section on deinstallation. Suggested by
	  Juergen Salk <juergen.salk@gmx.de>.
20001025: Makefile.in: if no pcrelib is installed, "make uninstall" or
	  "make uninstall-bins" will now remove pcre.7 as well. Patch
	  provided by Juergen Salk <juergen.salk@gmx.de>.
20001025: Makefile.in: "make install" now also creates
	  /var/spool/news/local.groups . Suggested by Stefan Fleiter
	  <stefan.fleiter@gmx.de>.

----------------------------------------------------------------------------

** History of 2.0b1 -- changes since 1.9.4:

applyfilter:
===========

20001018: for some reason, applyfilter doesn't work.
20001018: applyfilter was always called with argv[1]. Now it is called
	  with argv[optind] which ensures that the newsgroup is correct.
20000908: adjusted main() to new format of parseopt().
20000908: adjusted main() to new format of readconfig().
20000312: fixed call of lockfile_exists() to accommodate new format. Patch
	  by Joerg Dietrich <joerg@dietrich.net>.
19990801: terminate if filterfile is not present. Bug reported by
	  Marcus Szumigala <MSzumigala@gmx.net>.
19990721: fix .overview file after killing articles

fetchnews:
=========

20001018: doxover(): articles were actually not marked for download even
	  if filtering was successful
20001018: doxover(): an essential piece of code was missing to assemble an
	  article header from the xover line. Fixed.
20001017: doxhdr(): the message ids are now not logged anymore
20001013: doxover(): output of XOVER not logged any more
20001012: two new global variables, groupfetched and groupkilled, to count
	  fetched and killed articles per group.
20001012: doxover() loses one parameter which wasn't used anyway.
20000928: -F works again through new function getconffile().
20000927: switched back to reading config file *before* evaluating options.
	  However, this breaks -F.
20000927: managed to change the behavior of -S so that usernames and
	  passwords in the config file are used but servers *only* in
	  the config file are not.
20000927: new function do_server() which incorporates some functionality
	  of the former main().
20000914: moved supersede() into artutil.c. Patch by Joerg Dietrich
	  <joerg@dietrich.net>.
20000914: checkinteresting() should only be called if fetchnews is
	  invoked without -n. Fixed by Joerg Dietrich <joerg@dietrich.net>.
20000914: F: was missing in the getopt() call. Reported by Joerg
	  Dietrich <joerg@dietrich.net>.
20000908: added option "-M message-id" to retrieve only a single message-id
20000908: added option "-F configfile" to read from a different configuration
	  file
20000908: adjusted main() to new format of parseopt().
20000908: adjusted main() to new format of readconfig()
20000906: if "LIST NEWSGROUPS news.group.name" does not work for the first
	  new group, no second attempt to get a groupname is made. Suggested
	  by Carlos Robinson <cerobinson@teleline.es>.
20000906: some minor changes in main() and getfirstlast() (mostly removal
	  of debugging messages).
20000804: implemented catching of SIGUSR1 and SIGUSR2 to increase or
	  decrease verbosity on the fly. Patch by Colin Brough
	  <Colin.Brough@btinternet.com>.
20000804: implemented the new locking mechanism for fetchnews, to avoid
	  getting into troubles with the nntpd. Written by Joerg
	  Dietrich <joerg@dietrich.net>.
20000804: new function checkforpostings(). This avoids connecting with any
	  upstream server if there is nothing to post and fetchnews is
	  invoked with -P.
20000728: new function freeserverlist(), needed by main().
20000728: main(): regrouped some invokements.
20000728: main(): removed unused variable "usesupplement".
20000728: main(): implemented -S option, after a patch by Joerg Dietrich
	  <joerg@dietrich.net>.
20000728: main(): the configuration must be read before parsing the options.
	  Patch by Joerg Dietrich <joerg@dietrich.net>.
20000728: getgroup(): since the return value of getfirstlast() can be
	  negative, the variable x containing it cannot be unsigned. Bug
	  fixed by Joerg Dietrich <joerg@dietrich.net>.
20000728: getarticle(): free used memory. Patch by Joerg Dietrich
	  <joerg@dietrich.net>.
20000728: getarticle(): Joerg Dietrich <joerg@dietrich.net> added support for
	  Supersedes. TODO: this should only be conditionally switched on.
20000728: getfirstlast(): if the server does have an empty group, return
	  FALSE. Patch by Joerg Dietrich <joerg@dietrich.net>.
20000728: getfirstlast(): if more "extraarticles" are requested than there
	  are articles on the server, the function became confused (because
	  negative numbers were generated). Fixed by Joerg Dietrich
	  <joerg@dietrich.net>.
20000728: sigcatch() also catches SIGALRM now. Patch by Joerg Dietrich
	  <joerg@dietrich.net>.
20000714: moved age() to filterutil.c
20000714: doxover(): moved killing of maxage, maxlines, minlines, maxbytes
	  and maxcrosspost into filterutil.c. This has the advantage that
	  it is possible to apply these criteria in a newsgroup-specific
	  fashion.
20000714: getgroup(): removed the check to interesting.groups. Instead,
	  we check all groups once at the startup of fetchnews (and
	  texpire).
20000712: new function doxhdr() which is called if there are no filter
	  settings for a newsgroup. This should improve the speed because
	  in that case only Message-IDs and not complete headers have to
	  be transferred. Based on a posting to de.comm.software.newsserver
	  by Juergen Strohmayer <usenet@bigfoot.de>.
20000701: nntpactive(): since some wierd news servers have not implemented
	  LIST ACTIVE, use LIST instead
20000312: doxover(): removed strtok() code from 180100 because it didn't
	  work at all. Replaced it with the original code of 170100 and
	  re-inserted the bugfix from 230200. This code may still not be
	  fully correct.
20000312: fixed calls of lockfile_exists() to accommodate new format.
	  Patch by Joerg Dietrich <joerg@dietrich.net>.
20000304: insertgroup(): if fetchnews -f was called, creation time was
	  not set to 0. Bug discovered and fixed by Joerg Dietrich
	  <joerg@dietrich.net>.
20000223: doxover(): when maxage was set to 0, all articles were killed.
	  Bug reported by Johannes Stezenbach.
20000213: nntpactive(): new groups reported by NEWGROUPS were not inserted
	  in the groupinfo file (and would have been inserted with a wrong
	  date). Bug found and fixed by Joerg Dietrich <joerg@dietrich.net>.
20000118: rewrote doxover() based on code by Vladimir Dozen
	  <dozen@do-labs.spb.ru>.
19990113: if "LIST NEWSGROUPS" returned just "215" without any text, fetchnews
	  became confused. Reported by Pasqualino Casciano
	  <pasqualino.casciano@stud.lrz-muenchen.de>.
20000113: ismsgidonserver(): waited for more lines after a 430 error message.
	  Bug discovered and fixed by Joerg Dietrich <joerg@dietrich.net>.
20000108: doxover(): more informative error message if XOVER fails
20000108: doxover() returns now the correct values if all articles are
	  already downloaded.
20000101: ismsgidonserver() now uses HEAD instead of STAT since STAT
	  implementation is buggy with some nntp servers (problem
	  reported by Qing Liu <liu@math.u-bordeaux.fr>).
19991221: automatic unsubscription of groups got lost in the rewriting
	  process. Fixed (I used the leafnode-1.9.8 variant).
19991129: ismsgidonserver() re-written to care for buggy nntpcache (at least
	  some versions of nntpcache reply to STAT <msgid> with "223", even
	  if there is no article <msgid>).
19991125: lockfile is unlocked after writing active file since we don't
	  need to lock for writing overview files (at least I have not
	  encountered any locking problems with overview files so far,
	  and the nntpd doesn't lock either).
19991118: removed all the old code since the new one was working quite
	  satisfactorily as of 151199.
19991118: case of newsgroups is not changed anymore.
19991115: mgetheader(): various additions of globalfetched and globalkilled
	  made by Joerg Dietrich <joerg@dietrich.net>.
19991115: mgetheader(): space allocated for pseudo headers was not initialized
	  properly. Bug found and patched by Joerg Dietrich
	  <joerg@dietrich.net>.
19991109: getarticle(): before writing Xref: headers, an empty line was
	  inserted. Bug found and patched by Joerg Dietrich
	  <joerg@dietrich.net>.
19991109: getarticle(): fopenmsgid() was called with the message id, not
	  the pathname. Bug found and patched by Joerg Dietrich 
	  <joerg@dietrich.net>.
19991109: getarticle(): Xref: from upstream header should not be saved.
	  Bug found and patched by Joerg Dietrich <joerg@dietrich.net>.
19991106: filtering on maxlines and minlines did not always work. Bug found
	  and patched by Joerg Dietrich <joerg@dietrich.net>.
19991104: (old) getgroup(): if a header was not found, fetchnews would segfault.
	  Bug found and fixed by Arkadiusz Mi∂kiewicz <misiek@misiek.eu.org>.
	  (I thought I had fixed this already. Apparently not.)
19991101: mgetheader() did look for headers at the end of the line instead of
	  the beginning. Fixed.
19991101: age() now checks whether it gets a full "Date:" header or only the
	  date without the header.
19991101: doxover() debugged with ddd uncovered several small errors which
	  prevented the new getgroup() from running properly.
19991027: made a few changes to updateactive(): when atime of active.read was
	  newer than current date, it was not changed. Now, fetchnews also
	  produces a warning if this happens.
19991025: made a few changes to (old)getgroup()
19991016: Joerg Dietrich <joerg@dietrich.net> fixed a bug in doxover() which
	  prevented xoverlines from being parsed correctly.
19991008: getbody() deleted.
19991008: rewrote getmarked() because it was seriously f...ed up. It now
	  uses the new function getarticle() instead of getbody().
19991006: introduced new #define OLDVERSION which is set for the old version
	  and should be unset when trying to compile (and test) the new version
	  which still contains a gazillion of bugs.
19991006: delposted(): now we delete everything that was created in out.going
	  before fetchnews started instead of making lists. Saves memory and
	  is conceptually simpler (except if somebody has changed the clock
	  between the actual posting event and the call of fetchnews).
19991003: postarticles(): added a missing fclose() and a missing closedir()
	  when a timeout occurred during posting. Bug reported by Brian
	  Ewins <brian.ewins@bt.com>.
19990922: nntpactive(): if upstream server understands XGTITLE, new groups
	  and their descriptions were not entered in active file. Fixed
	  (hopefully). Bug discovered by Carsten Bobek <c.bobek@gmx.de>.
19990914: fixed a bug in getparam(): numerical parameters were not evaluated
	  correctly
19990912: getfirstlast(): now properly yields parameters
19990823: continued the "big rewrite". New functions are:
	  - getarticles(): get all articles in a newsgroup using overlapping
	    NNTP commands.
	  - getarticle(): getting the single article. This function is not
	    written yet.
	  - legalheaders(): check if a message has all legal headers present
	  - getmsgid(): extract message-id from headers in memory
19990818: usage(): program was still called "fetch". Reported by Christian
	  Fertig <fertig@informatik.uni-frankfurt.de>.
19990818: oldgetgroup(): if there were more than one blank between header
	  and header contents, the contents were mangled (not properly
	  truncated, that is). Bug reported by Gerd R. Greye
	  <gerd.greye@pironet.netsurf.de>.
19990805: removed all calls of tgetaline() since it did not work as
	  intended.
19990727: getgroup(): xover header are now filtered.
19990726: added check for message ids in getgroup().
19990726: messed around with processupstream() which didn't read its written
	  data properly
19990725: started the big rewrite of getgroup() (old getgroup() is called
	  oldgetgroup() in the meanwhile). New functions are:
	  - getfirstlast()
	    find out which are the first and last articles to get
	  - doxover()
	    get headers with XOVER, filter for various things and store them
	    if delaybody is used
	  - fopenmsgid()
	    store an article under /var/spool/news/message.id/ and create
	    subdirectories if needed
	  - getarticle()
	    get the article. Not written yet. May be split into gethead()
	    and getbody() (not sure yet).
19990724: handling of long ints was still incorrect in getgroup(). Fixed.
19990723: fetchnews now also catches SIGTERM.
19990721: getgroup() returns now unsigned long instead of int
19990721: processupstream(): declared newserver as "unsigned long" to improve
	  compatibility
19990721: activated -H and -B switches (most of the code was already present
	  in 1.9.4)

libutil:
=======

20001023: filterutil: messed around with killfilter() a bit more. Now it
	  seems to work.
20001023: filterutil: readfilter(): pcre_compile() was called with wrong
	  variable "l" instead of "value". Fixed by Joerg Dietrich
	  <joerg@dietrich.net>.
20001023: filterutil: killfilter(): parameters for call of findinheaders()
	  were switched.  Switched back by Joerg Dietrich <joerg@dietrich.net>.
20001023: filterutil: killfilter(): no check whether findinheaders() found
	  something before calling strtol(). This could lead to crashes.
	  Fixed by Joerg Dietrich <joerg@dietrich.net>.
20001023: filterutil: findinheaders() should not match on the whole line
	  but only on the length of "needle". Fixed by Joerg Dietrich
	  <joerg@dietrich.net>.
20001018: configutil: removed obsolete filter variables
20001018: miscutil: parseopt() does not log options any more
20001018: xoverutil: getxoverline() inserted tabs into the xoverline if
	  they were present in multiline headers. This confused texpire.
20001017: activutil: if insertgroup was called with a description of NULL,
	  it would crash because strdup(NULL) was called. Now "desc" is
	  checked beforehand.
20001013: miscutil: getoptarg() now uses findopt().
20001013: miscutil: new function findopt() which determines whether an
	  option is present on the command line without using getopt().
20001013: miscutil: renamed getconffile() to getoptarg() and allowed the
	  specification of the option. This makes the function more
	  universal.
20000928: miscutil: new function getconffile() allows parsing of command
	  line for a config file without using getopt(). Therefore, we
	  can still use getopt() after reading the config file, thus making
	  it possible to override settings in the config file.
20000928: miscutil: getaline() now uses GNU getline() if present. First
	  suggested by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
20000927: configutil: readconfig(): added "debugmode" option again because
	  I frequently forgot to type -D at the command line.
20000927: configutil: readconfig(): made servers again a global variable.
	  I am surprised that the original code had apparently worked
	  occasionally.
20000919: artutil: insertgroup() sets count for each group to 0.
20000919: artutil: readactive() sets count for each group to 0.
20000914: xoverutil: getxoverline() now preserves atime and utime of a file.
	  Patch by Joerg Dietrich <joerg@dietrich.net>. I am not sure
	  whether this is really needed because getxoverline() should
	  ideally be only called once - but it makes things more robust.
20000914: artutil: storearticle() now can and will supersede articles.
	  Patch by Joerg Dietrich <joerg@dietrich.net>. I am not sure
	  whether this is desirable; at least one should be able to
	  configure it.
20000914: artutil: added supersede() from fetchnews. Patch by Joerg
	  Dietrich <joerg@dietrich.net>.
20000908: miscutil: parseopt() modified to adjust new option -F.
20000908: configutil: readconfig() now takes two parameters to make it
	  possible to read different config files
20000904: miscutil: getaline() modified according to Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
20000830: activutil: found the newly introduced bug in readactive(). We
	  accidentally replaced also the last NUL byte with a space which
	  was stupid (and it was pure luck that it did not cause segfaults
	  so far).
20000829: activutil: readactive() threw around with complaints about
	  truncated groupinfo files. Fixed a first bug which might cause
	  crashes because we wrote into unallocated memory. This does
	  not fix the complaints, however.
20000824: miscutil: getaline() still had problems with NUL bytes. Now these
	  are replaced with spaces.
20000804: xoverutil: getxover() could not handle negative return values from
	  findxover which resulted in coredumps (the variable was declared as
	  "unsigned"). Fixed.
20000804: miscutil: findinlist(): if "needle" is a NULL pointer, return
	  NULL.
20000803: xoverutil: findxover() now returns (again?) -1 on error. (Since
	  an array can have an object indexed with 0, this object would
	  have never returned.)
20000803: activutil: fixed a bug in insertgroup(): the description was not
	  strdup()ed, leading to possible memory overwrites by other things.
	  This was only discovered when implementing local groups.
20000728: configutil: readconfig() now returns 0 in case of success and a
	  positive error number in case of failure which then can be
	  translated by the calling program (with strerror()). This should
	  reduce the number of inquiries concerning unreadable config files
	  somewhat.
20000728: configutil: readconfig() now returns servers as parameter, if
	  possible. Advantage: one global variable less.
20000724: miscutil: getaline(): doubling bytes again in an exponential
	  fashion; in addition patch for NUL bytes, provided by Matthias
	  Andree <matthias.andree@gmx.de>.
20000717: miscutil: initvars(): messed around with setuid() and getuid().
	  It should now again be possible to install fetchnews setuid news.
	  This ability was lost in the transition from 1.9.7 to 1.9.8.
20000717: miscutil: getaline() would double the line length when reading
	  incomplete lines. Now it allocates bytes in a linear fashion.
20000714: filterutil: new functions findinheader() and age() (the latter
	  comes virtually unchanged from fetchnews.c)
20000714: filterutil: changes in newfilter(), readfilter() and most
	  massively in killfilter() to accommodate group-wise "maxage",
	  "maxlines", "minlines", "maxbytes" and "maxcrosspost".
20000714: localutil: islocalgroup() declaration changed to remove a warning
20000714: miscutil: new function checkinteresting() goes through the
	  interesting.groups directory and deletes everything that is
	  not interesting.
20000712: nntputil: AUTHINFO USER and AUTHINFO PASS are now logged on
	  the debug facility. Username and password are, of course, not
	  logged.
20000705: miscutil: nntp traffic is only logged if programs are invoked
	  with at least two -D.
20000705: miscutil: islocal() replaced with islocalgroup() in localutil
20000705: new file localutil.c
20000701: xoverutil: removed stripspace() completely from the code that
	  creates the overview lines. This means that leading and trailing
	  blanks are not removed any more in any header line, nor are
	  consecutive blanks compressed. Suggested by Thomas Zajic
	  <zlatko@gmx.at>.
20000701: miscutil: added snprintf() from leafnode-1.9.14.
20000701: activutil: insertgroup() gets an additional parameter containing
	  the group description. We need this for local groups.
20000701: activutil: removed a superfluous "#include <string.h>"
20000319: activutil: mergeactive() now sets the "name" of the first
	  unused slot to NULL. Suggested by Claude Michel <cpjm@free.fr>.
	  (This may or may not cause a small memory leak.)
20000312: configutil: included some strategically placed "debug = 0" and
	  "debug = debugmode" lines in readconfig() to avoid logging the
	  whole file every time.
20000312: xoverutil: new function gfixxover() fixes overview lines for
	  each group in a comma-delimited string. Written by Joerg
	  Dietrich <joerg@dietrich.net>.
20000312: miscutil: new function islocal() checking whether a group is
	  local. Written by Joerg Dietrich <joerg@dietrich.net>.
20000312: miscutil: isinteresting() rewritten for local groups by
	  Joerg Dietrich <joerg@dietrich.net>.
20000312: miscutil: lockfile_exists now uses fcntl() to check for
	  already running instances of fetchnews (or other programs in
	  the leafnode suite). Rewritten by Joerg Dietrich
	  <joerg@dietrich.net>.
20000312: artutil: now function lookup_xref(). This function looks up a
	  group in an xref line and returns the article number if the
	  group is present, otherwise NULL. Written by Joerg Dietrich
	  <joerg@dietrich.net>.
20000312: activutil: fakeactive() now also checks local groups. Patch by
	  Joerg Dietrich <joerg@dietrich.net>.
20000310: artutil: storearticle() was still broken. Massive patch by Joerg
	  Dietrich <joerg@dietrich.net>. (Joerg had submitted a similar
	  patch before but I apparently misplaced it.)
20000304: artutil: fgetheader() will now remove the : by itself even
	  if not given in the "header" parameter.
20000304: activutil: insertgroup() changed creation times of already
	  existing groups, causing them to be displayed as new. Bug
	  independently fixed by Johannes Stezenbach and Joerg Dietrich
	  <joerg@dietrich.net>.
20000304: activutil: helpfindgroup() modified which speeds up the time to find
	  a group. Prompted by benchmarking the code to some code written by
	  Tony de Haan <tony@iae.nl>.
20000304: miscutil: new functions stringlistlen() and cmdlinetolist(),
	  written by Andreas Ferber <aferber@techfak.uni-bielefeld.de>.
20000223: xoverutil: getxoverline() now ignores Lines: headers and computes
	  the correct number by itself. Suggested by Johannes Stezenbach.
20000222: miscutil: replaced the fnmatch() code in ngmatch() with Rich
	  Salz's original wildmat().
20000213: activutil: fixed small bug introduced yesterday
20000212: activutil: Lloyd Zusman <ljz@asfast.com> discovered and plugged
	  a memory hole in readactive(): new function freeactive().
20000129: activutil: changegroupdesc() crashed when receiving NULL pointers.
	  Bug fixed by Joerg Dietrich <joerg@dietrich.net>.
20000129: miscutil: ngmatch(): case-insensitive regexp now indeed terminates
	  with '\0'. Bug fixed by Joerg Dietrich <joerg@dietrich.net>.
20000118: activutil: writeactive() does not write empty records any more.
	  Code taken from 1.9.10b2.
20000118: readactive: first and last article set to 1 if they are 0.
20000118: xoverutil: improved code for deletion of illegal articles after
	  bug reports by Andy Piper <squiggle@ukgateway.net>.
20000108: xoverutil: return value of mkstemp() was tested in the wrong way.
	  Fixed.
20000108: activutil: fakeactive() successfully debugged. This means that all
	  functions in activutil.c have been successfully tested.
20000108: activutil: helpfindgroup() now uses signed longs instead of
	  unsigned ones. This solves a lot of problems.
20000108: activutil: insertgroup() could not deal with already existing
	  groups. Fixed.
20000108: activutil: readactive() missed a free( buf ). Fixed.
20000107: activutil: fakeactive() now disregards subgroups starting with
	  digits (this still doesn't help against group names which consist
	  entirely of digits, such as alt.2600)
20000107: activutil_new moved to activutil
20000107: moved isinteresting() from activutil to miscutil.
20000107: miscutil: removed "active = NULL" from initvars().
20000106: activutil: completely rewritten to use arrays instead of trees,
	  unfinished version stored in activutil_new.c. readactive()
	  and writeactive() have already been tested successfully.
20000106: configutil: no more "debugmode" parameter. Use -D instead.
20000106: miscutil: ngmatch() converts a pattern that does not contain
	  ranges into a case-insensitive pattern before using fnmatch()
	  on it.
20000106: filterutil: implemented more intricate filtering rules. This
	  involved a major rewrite of readfilter() and dofilter() (now
	  called killfilter()) and the new functions newfilter(),
	  selectfilter() and freefilter().
20000104: miscutil: replaced ngmatch() with the version from leafnode-1.9.7.
	  This makes string comparison sometimes case-insensitive and fixes
	  a bug reported by Daniel Barron <daniel@jadeb.com>: in config.h.in,
	  HAVE_FNMATCH is defined; but in miscutil.c, HAVE_FNMATCH_H was used.
20000103: miscutil: initvars(): setreuid() and setregid() are replaced
	  by setuid() and setgid() if possible. Patch by Bruno Rohee
	  <rohee@OpenBSD.ORG>.
20000103: xoverutil: getxover(): open(mktemp()) replaced with mkstemp()
	  if possible. Patch by Bruno Rohee <rohee@OpenBSD.ORG>.
19991201: configutil: readconfig(): parameter was missing if an username
	  was found in a file without a server. Reported by Bruno Rohee
	  <rohee@OpenBSD.ORG>.
19991125: xoverutil: getxoverline() now also allows tabs behind the colon
	  in headers. Problem reported by Radoslaw Gancaraz <r_g@priv2.onet.pl>.
19991122: miscutil: chdirgroup(): tolower() now casts its argument like
	  isspace() etc.
19991122: miscutil: lockfile_exists(): getpid() now cast to int.
19991119: activutil: readactive(): if reading is truncated, st.st_size is now
	  cast to int. Submitted by Bruno Rohee <rohee@OpenBSD.ORG>.
19991119: activutil: helpwriteactive(): g->age cast to unsigned long.
	  Submitted by Bruno Rohee <rohee@OpenBSD.ORG>.
19991119: activutil: readactive(): when groupinfo was not a regular file,
	  leafnode would crash. Bug discovered and fixed by Bruno Rohee
	  <rohee@OpenBSD.ORG>.
19991118: activutil: writeactive() does not change case of newsgroups anymore.
19991118: miscutil: removed lowercase() (not necessary anymore).
19991118: miscutil: made the replacement code for fnmatch() case-insensitive.
19991109: filterutil: dofilter() returned a hit when no filter file was
	  present. Bug found and fixed by Joerg Dietrich <joerg@dietrich.net>.
19991109: xoverutil: hopefully the last patch (this time to findxover() which
	  would be unable to find certain articles and segfault with others).
	  Bug found by Joerg Dietrich <joerg@dietrich.net>.
19991108: xoverutil: some more patching in getxover() to get everything right.
19991107: xoverutil: spent about four hours hunting a bug which lead to a
	  segfault (xcount was set 1 too high in getxover() which resulted
	  in the crash of writexover()). I have no idea when this problem
	  was introduced as I had not encountered any problems with crashes
	  since 011199.
19991103: miscutil: daylight savings time was not correctly honoured in
	  rfctime(). Bug reported by Diedrich Ehlerding
	  <diedrich.ehlerding@t-online.de>.
19991101: xoverutil: writexover() would always forget to write the overview
	  record for the latest article.
19991101: configutil: when setting the core limit, the struct is now first
	  initialized by calling getrlimit().
19991101: miscutil: initvars() now always sets the access rights for
	  /var/spool/news/out.going to rwsr-xr-x.
19991028: miscutil: patched rfctime() to remove unnecessary variables (leftovers
	  from leafnode-1.4) and to accommodate new member of struct tm, based
	  on a patch by Michael Mauch <michael.mauch@gmx.de>
19991023: configutil: removed "newsrc" option
19991023: configutil: new option "pseudoarticle" to use an arbitrary
	  pseudoarticle
19991009: miscutil: new version appendtolist() adds a new entry to a
	  stringlist. Replaces lots of code at different places in
	  fetchnews.c.
19990922: activutil: a closedir() was missing in fakeactive(). Bug discovered
	  and fixed by Brian Ewins <Brian.Ewins@gssec.bt.co.uk>.
19990920: xoverutil: fixed a bug in getxover() which was introduced on
	  290899 and caused fetch to crash (a pointer was freed twice).
19990830: artutil: applied a patch from Greg Weeks <greg@durendal.tzo.com>
	  to storearticle() which makes rnews work properly in pipes.
19990829: xoverutil: rewrote getxover() completely. The .overview file
	  is now also written if files are deleted. Furthermore, there
	  should be no more memory shortage if there are articles with
	  very different numbers in a newsgroup. (This bug was first
	  reported by Giulio <giuliox@tin.it>.)
	  New functions:
	  - findxover() and helpfindxover(): find the index entry for an
	    article number. findxover() is also called by nntpd.
	  - _compxover(): sorts the .overview file with qsort(3).
19990828: xoverutil: removed some error messages from getxover() which
	  were mostly bogus (because you got them if a newsgroup started
	  with a digit).
19990828: nntputil is included into libutil.a again
19990824: nntputil is not included into libutil.a anymore
19990824: nntputil: rewrote putaline() (needs no global lineout anymore)
19990823: filterutil: dofilter() gets article number as additional parameter
19990819: xoverutil: getxover(): would try to get xover information from
	  directories starting with digits. Bug reported by a number of
	  people, among them Jeff Grossman <jeff@stikman.com>.
19990819: xoverutil: getxover(): the .overview file could be left open if
	  some other condition than its opening failed. Fixed.
19990809: activutil: isinteresting() missed a few closedir() calls
19990805: nntputil: tgetaline() removed
19990805: configutil: new global variable "filtermode" which cannot yet
	  be set. Will allow choosing between filtering xover headers or
	  real article headers.
19990805: configutil: servers now logged to LOG_DEBUG, not LOG_INFO
19990801: filterutil: filterlist is initially NULL
19990801: filterutil: readfilter() now returns FALSE if filterfile could not
	  be read.
19990725: filterutil: compiling filter verbose message switched off again
19990724: activutil: isinteresting() now uses readdir() instead of stat
	  (i.e. it will not access the inode any more); the parameter
	  is now declared "const".
19990722: xoverutil: getxover() checked wrong condition if a file was
	  "illegal". Bug discovered and fixed by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
19990721: xoverutil: new function writexover().
19990721: changed type of xfirst/xlast to unsigned long.
19990721: moved initialization of xfirst/xlast/xover structure from miscutil.c
	  to xoverutil.c (declaration).
19990721: artutil: switched various format strings from int to unsigned long
19990721: activutil: switched format in helpwriteactive() to unsigned long
19990721: configutil: switched artlimit and initiallimit from int to unsigned
	  long.
19990721: activutil: readactive(): initialized desc to NULL. Patch by
	  Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
19990721: configutil: readconfig(): initialized p and q to NULL. Patch by
	  Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
19990721: miscutil: declared namelen as unsigned int instead of int. Patch
	  by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
19990721: nntputil: removed a register declaration from nntpconnect() and
	  made two variables static (removes pgcc warnings and solves some
	  ominous problems). Patch by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
19990721: xoverutil: do not expire files starting with '.'. Based on a
	  patch by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
19990721: configutil: new parameter "newsrc" (not used yet)
19990721: filterutil: compiling filters is shown when being verbose

newsq:
=====

20000908: adjusted main() to new format of parseopt().
19991129: should now also print correctly if sizeof(off_t) == 8
19991122: #include <sys/types.h> (required by HP/UX and possibly others)

nntpd:
=====

20000919: dogroup() now indeed returns the approximate number of articles
	  in the group, not just (g->last - g->first) .
20000918: changed doselectedheader() to return 420 if no article is in the
	  specified range.
20000917: Joerg Dietrich <joerg@dietrich.net> fixed broken doselectedheader().
20000917: Joerg Dietrich <joerg@dietrich.net> changed all calls of
		  ngmatch( l->string, pattern )
	  to
		  ngmatch( (const char*)&(l->string), pattern ).
	  This is necessary because a stringlist entry l is not a struct of
	  two pointers (one to the next entry, the other to the string) but
	  contains the actual string.
20000914: removed some more superfluous \r\n in various nntpprintf() calls
	  (patch by Joerg Dietrich <joerg@dietrich.net>).
20000913: doxover(): XOVER for an empty range returned 224, not 420.
	  Fixed.
20000913: doxover(): XOVER returned all articles, not only the current one.
	  Fixed.
20000908: new option -F to read from different config file.
20000908: adjusted main() to new format of parseopt().
20000908: adjusted main() to new format of readconfig().
20000904: doselectedheader(): "XHDR [header] <message-id>" always returned
	  the first header of strlen(header) in the file, without checking
	  for identity. Bug reported by Andrzej Radecki <radecki@wpk.p.lodz.pl>.
20000808: doselectedheader(): now also can return a Newsgroups: header for
	  pseudoarticles if "XHDR Newsgroups" is requested. Suggested by
	  Karen Nakamura <mail@gpsy.com> because MT Newswatcher needs it.
20000804: new function gmtoff(), written by Joerg Dietrich <joerg@dietrich.net>,
	  calculates a reliable difference between localtime and GMT. Some
	  help from Oisin Curtin <ocurtin@usa.net> and Radoslaw Gancarz
	  <r_g@priv2.onet.pl>.
20000803: dohelp(): added "list overview.fmt"
20000803: dolist(): removed a few superfluous \r\n
20000803: main(): added invocation of readlocalgroups(). This makes local
	  groups work with the nntpd.
20000803: nntpprintf(): now fflush() stdout after printing. This seems to
	  fix a problem of incomplete threading in tin.
20000705: removed the "justaftergroup" mechanism. Instead, groups are now
	  marked if one of the following NNTP commands is encountered:
	  - GROUP if the group was already interesting
	  - LISTGROUP
	  - XHDR
	  - XPAT
	  - XOVER
	  - ARTICLE
20000705: dogroup() now marks a group as interesting if it was already in
	  the list of interesting groups, but not otherwise. This solves
	  some problems with Knode. Suggested by Christian Gebauer
	  <gebauer@bigfoot.com>.
20000705: calls to islocal() replaced with calls to islocalgroup().
20000701: dopost(): if owndn is set, it is now also included in the Path:
	  (not only used for the message ID). Suggested by Mark Brown
	  <broonie@tardis.ed.ac.uk>.
20000331: donewnews() and donewgroups(): external variable timezone does
	  not exist on BSD. Replaced with tm_gmtoff.
20000312: dopost(): articles are now immediately sorted into the spool.
	  This is achieved by fork()ing. nntpd ignores SIGCHLD therefore
	  (in main()).
	  One problem is that now fetchnews and the nntpd cannot be
	  run at the same time (?).
20000312: dogroup() now always calls rereadactive() before looking for the
	  groupname. Patch by Joerg Dietrich <joerg@dietrich.net>.
20000312: markinterest() returns immediately (and does not touch files in
	  $SPOOLDIR/interesting.groups) if a group is local.
20000310: NEWGROUPS and NEWNEWS now only care for timezone if the client does
	  not explicitely request "GMT". Patch by Joerg Dietrich
	  <joerg@dietrich.net>.
20000304: parser() now also understands PAT in addition to XPAT.
20000304: dohelp() adjusted for NEWNEWS capabilities.
20000304: new function donewnews() to support NEWNEWS. This function is
	  still somewhat crude in that it does not care for timezones.
20000304: NEWGROUPS now also cares for timezone. Patch by Johannes
	  Stezenbach.
20000304: Andreas Ferber <aferber@techfak.uni-bielefeld.de> merged
	  doxpat() and doxhdr() into new function doselectedheader().
	  doxpat() and doxhdr() remain as small wrappers.
20000227: fprintpseudobody(): now contains new URL for leafnode. Reported
	  by Thomas Bader <thomasb@trash.net>.
20000223: dohelp() and dolist() adjusted for new XPAT capabilities.
20000223: new function doxpat(), written by Andreas Ferber
	  <aferber@techfak.uni-bielefeld.de>. This enables the nntpd
	  to understand the XPAT command.
20000213: removed shadow code from doauthinfo() (does not work because
	  nntpd never runs as root).
20000116: doxhdr() now returns (none) if asked for XHDR REFERENCES of an
	  article. Suggested by Ted Marston <ted@nowtsfree.freeserve.co.uk>;
	  increases compatibility with xrn.
20000108: donewgroups() and list() do not traverse trees any more but just
	  zoom through the whole array of "active". This avoids a lot of
	  recursive invoking of functions and therefore may be faster.
20000103: donewgroups(): some buggy newsreaders send date in the form YYYMMDD.
	  We now parse these dates successfully. Bug first reported by
	  Nick Drage <nick-drage@gmx.ch>.
19991221: markinterest() changed both mtime and atime if file was already
	  present. Fixed. (A problem with the expiry mechanism had been
	  reported by several people but it was quite difficult to track it
	  down.)
19991210: if the domainname is set in the config file, it is now also used
	  in the Path:. Suggested by Klaus Berger <klausmartin.berger@gmx.net>.
19991201: dopost(): if spoolfile could not be opened, argument was missing
	  in syslog() call. Reported by Bruno Rohee <rohee@OpenBSD.ORG>.
19991125: dopost() now also allows tabs behind the colon of headers.
19991118: case of newsgroups is not changed anymore.
19991104: parser() now also skips leading spaces.
19991101: removed rereadactive() calls from parser() and put them into
	  dolist() and dogroup(). This should save a little time.
19991023: new function fprintpseudobody(): print body of an arbitrary
	  pseudoarticle and do certain replacements
19991017: donewgroups(): fixed a bug with the year 2000 (centuries were not
	  handled properly). Reported by Michael Schuetz
	  <michael.schuetz@tu-clausthal.de>.
19991017: main(): nntpd did not complain if it could not read configuration
	  file. Bug reported by Alexander Rudyk <alexrudyk@arnet.de>.
19991008: dopost(): leafnode now doesn't accept postings if headers are
	  longer than 1000 chars. It is not very strict, e.g. it doesn't
	  check for multiline headers. (IMO, it shouldn't care at all
	  and in fact is capable of transferring headers of arbitrary
	  length, but several users requested this "feature".) Requested by,
	  among others, Diedrich Ehlerding <Diedrich.Ehlerding@t-online.de>.
19991008: fixed a bug in markdownload(). For some reason, local article
	  numbers were logged, not message-ids. I have no idea when this
	  bug crept in, but it explains the long number of complaints about
	  the delaybody function not working properly.
19991003: fixed a typo in the pseudoarticle (found by Jeffrey Goldberg,
	  <J.Goldberg@cranfield.ac.uk>)
19990924: added syslog connection logging (patch by Brent J. Nordquist,
	  <brent-nordquist@bethel.edu>)
19990922: parser(): if an unknown command was received, the nntpd sent an
	  empty line in addition to the "500" reply (probably introduced
	  on 260799). Fixed.
19990726: parser(): if command line length == 0, now continue silently (works
	  better with Netscape?). Possible problem reported by Manfred
	  Haertel <Manfred.Haertel@rz-online.de>.
19990726: some small changes by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
19990726: new function nntpprintf(), written by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
19990721: implemented AUTHINFO USER and AUTHINFO PASS, based on /etc/passwd
	  or /etc/shadow. With some help from a patch for PAM by Mark Brown
	  <broonie@tardis.ed.ac.uk>.
	  Problem: if one uses /etc/shadow, authentification will fail because
	  nntpd is running as uid news and therefore cannot access the
	  shadowed password file.
19990721: declared artno as unsigned long (not long). Patch by Matthias
	  Andree <ma@dt.e-technik.uni-dortmund.de>.
19990721: fopenpseudoart: article number now unsigned long. Patch by
	  Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.

rnews:
=====

(rnews was originally written for a planned 1.10 version and has on
   210799 become part of 2.0.)

20000908: adjusted main() to new format of parseopt().
20000312: fixed call of lockfile_exists() to accommodate new format. Patch
	  by Joerg Dietrich <joerg@dietrich.net>.
20000310: some patches to avoid full logging of articles in rnews (by
	  Joerg Dietrich <joerg@dietrich.net>). According to him, rnews
	  does not work in pipes yet.
19991217: uncompressfile(): replaced exit() with _exit().
19990721: rnews included into version 2.0 (does not compile successfully yet,
	  because decompression and xoverfile fixing don't work yet)
19990627: copyfile() moved to miscutil.c (patch by Joerg Dietrich
	  <joerg@dietrich.net>)
19990610: rnews did not work properly with directories. The reasons were
          twofold: first, rnews refused to work with relative directories;
	  second, rnews didn't account for chdir()s used when storing the
	  article (with storearticle()). Bugs described and fixed by Joerg
	  Dietrich <joerg@dietrich.net>.
19990603: copyfile() would try to read after the end of news batches. Bug
	  detected and fixed by Joerg Dietrich <joerg@dietrich.net>.
19990603: copyfile(): renamed variable "total" to "copied" to clarify its
	  use.
19990412: rnews always wanted to read something from stdin. Fixed.
19990412: rnews now properly recognizes when decompression failed and removes
	  temp files
19990411: rnews can now also read stuff from stdin
19990402: first working version of rnews

texpire:
=======

20001023: save_thread(): Joerg Dietrich <joerg@dietrich.net> removed a bug
	  introduced by me probably on 180800.
20000919: dogroup() failed if there was (for whatever reason) no .overview
	  file. Now, if no .overview file can be found, getxover() is
	  invoked.
20000914: getxover() is invoked at the end of a run.
20000914: threading now is only ensured down to a certain depth defined by
	  THREADSAFETY. Patch by Joerg Dietrich <joerg@dietrich.net>.
20000908: new option -F to read from different config file
20000908: adjusted main() to new format of parseopt().
20000908: adjusted main() to new format of readconfig().
20000821: modified dogroup() - hopefully now every single article is by
	  default tagged for deletion and will only be rescued if certain
	  conditions are fulfilled.
20000821: texpire crashed with a segmentation fault if no active file could
	  be read. Bug described by Shaul Karl <shaulk@israsrv.net.il>; patch
	  by Mark Brown <broonie@tardis.ed.ac.uk>.
20000818: texpire contains some bug when allocating the overview info. This
	  is very obvious if you swap the pointer to overview to the end of
	  the exp{ } struct - texpire will then collapse with a segfault. I
	  have not located the problem yet, however.
20000818: added some comments when trying to understand the new threading
	  code by Joerg Dietrich.
20000714: included call to checkinteresting().
20000701: expiregroup(): checks now also if the pointer g exists. Bug reported
	  by Peter Katzmann <peter.katzmann@knuut.de>.
20000312: replaced some strange succession of rewinddir() ... closedir() with
	  a closedir() call. Based on a suggestion of Stephen Marley
	  <stephen@home.uklinux.net> for leafnode-1.9.x.
20000312: fixed call of lockfile_exists() to accommodate new format. Patch
          by Joerg Dietrich <joerg@dietrich.net>.
20000129: speedup patch by Joerg Dietrich <joerg@dietrich.net>
20000109: code cleanup in savethread() by Joerg Dietrich <joerg@dietrich.net>
20000109: fix expiregroup(), by Joerg Dietrich <joerg@dietrich.net>
20000109: Joerg Dietrich <joerg@dietrich.net> added option -D.
20000108: expiregroup(): rewritten for use of arrays instead of trees.
19991221: dogroup(): article numbers are not reset when a group is empty
	  because this results in new articles not being displayed in
	  low-traffic groups.
19991201: dogroup(): converted some %d to %lu when printing "artno". Reported
	  by Bruno Rohee <rohee@OpenBSD.ORG>.
19991201: lookup_expire() now defined as "static time_t".
19991125: texpire now indeed expires articles by thread. Patch by Joerg
	  Dietrich <joerg@dietrich.net> which introduces two new functions,
	  xoverextract() and savethread(), and patches dogroup(). This
	  patch is supposed to also fix the memory allocation problem when
	  article numbers are *very* different.
19990828: dogroup(): when determining the first and last articles in the
	  group, we now stat() every article and check whether it is a
	  regular file. This saves troubles with groups like alt.2600
	  where a directory alt/2600 exists and the 2600 was mistaken as
	  an article number. Bug first reported by Holger Repp
	  <retaliator@sbsd.de> and explained by Jeff Grossman
	  <jeff@stikman.com>.

Miscellaneous:
=============

20001018: removed COPYING (license is now in README)
20001018: partially updated README (from a new README.html)
20001018: updated the leafnode.8 manpage
20001018: leafnode.h: removed obsolete external variables
20001018: updated the fetchnews.5 manpage
20001017: adjusted README
20001012: replaced all (hopefully) occurrences of the old leafnode URL with
	  http://www.leafnode.org/.
20000927: leafnode.h: struct serverlist has new flag "active" which is
	  set to TRUE for servers that should be indeed queried. This
	  allows specification of several servers with "fetchnews -S".
20000919: leafnode.h: removed "int alive" from struct newsgroup and
	  inserted "unsigned long count" instead.
20000906: makerpm.sh: patch by Karsten Merker <merker@linuxtag.org> to
	  accommodate new names of tarballs created on 090800.
20000809: Makefile.in: "make dist" now generates two tarballs, one with and
	  one without PCRE code. Based on a suggestion of Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
20000718: replaced all occurrences of exit(1) with exit(EXIT_FAILURE).
20000717: Makefile.in: fetchnews is now installed mode 6755. Together with
	  the changes in initvar() this should solve the FAQ of "how can I run
	  fetchnews as user?". Suggested by Gunnar Ritter <g-r@bigfoot.de>.
20000717: adjusted configure.in
20000705: FAQ: added an explanation how to use sudo, originally written
	  by Gerhard Schromm <Gerhard.Schromm@student.uni-ulm.de>.
20000705: leafnode.h: added extensions of localutil.c
20000705: Makefile.in: added localutil.c
20000701: makerpm.sh: now also works with SuSE. Patch by Juergen Salk
	  <juergen.salk@gmx.net>.
20000331: configure.in: now also test for snprintf() and vsnprintf(). So far
	  this has no consequences - we don't yet have a replacement which
	  is licensed under a free non-GPL license.
20000319: Makefile.in: man pages now installed with "install" instead of "cp".
	  Suggested by Mike Castle <dalgoda@ix.netcom.com>.
20000312: leafnode.h: additional functions added by Joerg Dietrich
	  <joerg@dietrich.net>.
20000312: Makefile.in: "make install" now creates additional directory
	  $SPOOLDIR/local.groups . Patch by Joerg Dietrich <joerg@dietrich.net>.
20000310: Makefile.in: "make dist" now includes the FAQ in the .tar.gz file.
	  Noted by Joerg Dietrich <joerg@dietrich.net>.
20000310: Makefile.in: "make clean" now also removes rnews. Patch by Joerg
	  Dietrich <joerg@dietrich.net>.
20000224: FAQ now contains a paragraph why Leafnode is not licensed under
	  the GPL.
20000213: fixed small bug in configure.in which was introduced yesterday
20000213: merged configure.in with the 1.9.11 version
20000212: configure.in now checks for system includes. Suggested by Matthias
	  Andree <mandree@dosis.uni-dortmund.de>
20000212: FAQ added from 1.9.10
20000131: added "char status" to newsgroups definition in leafnode.h
20000131: "supplement" removed from documentation.
20000118: ./configure now also checks for strtok().
20000116: changes in config.example and leafnode.8 suggested by Mark Brown
	  <broonie@tardis.ed.ac.uk>.
20000113: some changes in Makefile.in suggested by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
20000108: leafnode.h: removed unnecessary elements "left" and "right" from
	  struct newsgroup.
20000107: Makefile.in: "make install" now sets /etc/leafnode/config* to mode
	  600 and user:group "news".
20000106: fetchnews.8: rewritten to make room for new options (some of which
	  are currently still unimplemented)
20000106: Makefile.in: re-added -lpcre to the rule for making applyfilter
20000103: Makefile.in: /var/spool/news/failed.postings was not installed
	  during "make install"
20000103: added checks for setuid(), setgid() and mkstemp() to configure.in.
	  Patch by Bruno Rohee <rohee@OpenBSD.ORG>.
19991221: added "fetchnews -n" to the troubleshooting section of the README.
19991215: corrected a small bug in makerpm.sh (version was hard-coded). Problem
	  reported by Riccardo Tromba <inafir@tin.it>.
19991213: Karsten Merker <merker@guug.de> reanimated makerpm.sh of 1.9.6 and
	  added some changes to Makefile.in. I have tried to transplant these
	  changes to the 2.0 version as well.
19991201: removed lookup_expire() from leafnode.h
19991130: configure.in: removed size determination of off_t entirely.
19991130: configure.in: discovered a bug in autoconf-2.13 which prevents
	  correct determination of sizeof(off_t). Akim Demaille <akim@epita.fr>
	  showed me a way how to circumvent it.
19991129: configure.in: check sizeof(off_t)
19991125: configure.in: now detect BSD4.2-style syslog. Appropriate changes
	  have been included in the various C files (involving the openlog()
	  call).
19991121: config.example: added "hostname" parameter.
19991121: updated INSTALL file.
19991121: lsort now properly closes its input file. Fix by Joerg Dietrich
	  <joerg@dietrich.net>.
19991121: minor fix in lsort to accommodate really long groupinfo files
	  (i is now unsigned long instead of int), written by Joerg
	  Dietrich <joerg@dietrich.net>.
19991118: lsort now properly sorts the stuff (sorted only small files
	  previously). Problem was that qsort uses pointers to the
	  array members instead of the members itself.
19991117: new program lsort, written by Joerg Dietrich <joerg@dietrich.net>
	  to circumvent problems with buggy sort versions from old GNU
	  textutils (1.11).
19991117: Makefile.in: directories not built anymore when installing (this
	  is done on demand instead).
19991109: "filterfile" parameter was not mentioned in config.example.
	  Reported by Malte Gell <malte.gell@gmx.net>.
19991105: fixed a bug in configure.in which prevented proper detection of
	  tm_gmtoff. Problem reported by Ron Rosson <insane@oneinsane.net>.
19991028: changed configure.in to accommodate new members of struct tm in
	  miscutil.c
19991018: removed "#include <sys/types.h>" and "#include <regex.h>" from
	  leafnode.h (not needed since we use PCRE)
19991009: some miscellaneous patches by Joerg Dietrich <joerg@dietrich.net>
	  to make leafnode glibc2-compatible.
19991008: leafnode.h: BODY_DOWNLOAD_LIMIT deleted (not needed anymore)
19990924: update.sh: some constructs replaced with more portable one. Patch
	  by Brent J. Nordquist <brent-nordquist@bethel.edu>.
19990809: update.sh now uses /bin/sh instead of /bin/bash. Suggested by
	  Richard van Denzel <richardd@interaccess.nl>.
19990726: added catalan mini-HOWTO by Carles SadurnÌ Anguita
	  <sadurni@benidorm.net>.
19990726: fiddled with autoconf (updated configure)
19990722: configure.in: --without-ipv6 would not work as an option. Bug
	  reported by Roman Hodek <Roman.Hodek@informatik.uni-erlangen.de>,
	  patch by Mark Brown <broonie@tardis.ed.ac.uk>.
19990721: leafnode.h: switched "first" and "last" in newsgroup declaration
	  from int to unsigned long.
19990721: INSTALL: explanation how to upgrade an installed SuSE RPM with newer
	  leafnode sources provided by Matthias Andree
	  <ma@dt.e-technik.uni-dortmund.de>.
19990721: Makefile: new "make uninstall-bins" removes only executables and
	  manpages. Patch by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
19990721: Makefile: "make clean" removes now emacs-style backup files as well.
	  Patch by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
19990721: Makefile: $MAKEFLAGS now declared as -$(MAKEFLAGS). This solves
	  the problem that leafnode does not compile under HP/UX and allows
	  "make -k". Patch by Matthias Andree <ma@dt.e-technik.uni-dortmund.de>.
19990721: integrated rnews from 1.10b2 into leafnode package

=============================================================================

* Changelog for old versions

The changelog of versions before 2.0 can be found at
	  http://wpxx02.toxi.uni-wuerzburg.de/~krasel/ln.changes.html
