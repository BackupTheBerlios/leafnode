2004-12-13  Matthias Andree <matthias.andree@gmx.de>
  * ignore tags/TAGS

    M ./.boring +2

  * filter new postings
  Filters, if defined, are also matched against new postings, which will
  be rejected when the filter decides "kill". To support "local-groups-only"
  setups as asked for by Lloyd Zusman.

    M ./NEWS +3
    M ./nntpd.c +35

  * readheaders split-out
  Split readheaders and readtodelim out into a separate file.
  Move MAXHEADERSIZE to leafnode.h.
  Change readheaders API so it takes the delimiter as argument.

    M ./Makefile.am +1
    M ./applyfilter.c -68 +1
    M ./leafnode.h +9
    A ./readheaders.c

  * Add short instruction file for the new DARCS repo.

    A ./index.html

  * Split repository export to export.sh

    A ./export.sh
    M ./release.sh -10 +2

  * update for darcs

    M ./release.sh -1 +10

  tagged leafnode-2-0-0-alpha20041213a


  * bump version

    M ./configure.ac -1 +1

  * Ignore build*

    M ./.boring +1

  tagged leafnode-2-0-0-alpha20041213a


  * Update for darcs.

    M ./release.sh -3 +3

  * Add new changelog generator script.

    A ./makechangelog.pl

  * snapshot-20041213a

    M ./.boring +1
    M ./ChangeLog +44
    M ./NEWS -1 +2

2004-12-04  Matthias Andree <matthias.andree@gmx.de>
  * ignore generated files

    M ./.boring +22

  * Add more ignore entries.

    M ./.boring +4

  * convert .cvsignore to .boring
  we now have regexps rather than globs and use one global file for the
  whole repository.

     ./.cvsignore -> ./.boring
    M ./.boring -87 +17
    R ./tools/.cvsignore

  tagged initial darcs import
  (repository converted to darcs)

2004-11-17  Matthias Andree <matthias.andree@gmx.de>
  * Change: More useful logging when getting the range of articles in a
  Change: More useful logging when getting the range of articles in a
  group, now includes the server name.
  

    M ./NEWS +2
    M ./fetchnews.c -17 +20

2004-11-15  Matthias Andree <matthias.andree@gmx.de>
  * add missing word

    M ./NEWS -1 +1

2004-11-15  Matthias Andree <matthias.andree@gmx.de>
  * Bugfix: get rid of cosmetic "Groupinfo file damaged, ignoring line: 18"
  Bugfix: get rid of cosmetic "Groupinfo file damaged, ignoring line: 18"
  Change: when complaining about damaged groupinfo file, print the line number
  and encapsulate the line in double quotes.
  

    M ./NEWS +5
    M ./activutil.c -3 +5

2004-11-13  Matthias Andree <matthias.andree@gmx.de>

	= snapshot 20041113a =
	* NEWS, activutil.c:
	- Speedup: the active file now has a header line that contains the
	number of lines. leafnode can read both the old format (requires two
	passes) and the new format (requires one pass).
	- Speedup: the active file is now mmapped, rather than read, into
	memory.  Patch by Robert Clark.
	* getaline.c, leafnode.h: Add getabufferedline, based on a patch by
	Robert Clark.
	* CREDITS: List Robert Clark.  Convert to UTF-8.

2004-10-07  Matthias Andree <matthias.andree@gmx.de>

	= snapshot 20041007a =
	* NEWS, nntpd.c: leafnode will no longer print the moderator of
	local groups in the newsgroup list.  leafnode will make sure that a
	moderated group has the ' (Moderated)' tag in its description.
	* activutil.c, NEWS: fetchnews will flag groups as moderated if the
	reported status flag is 'y' but the group has the tag '
	(Moderated)'.

2004-10-06  Matthias Andree <matthias.andree@gmx.de>

	= snapshot 20041006a =
	* fetchnews.c: Quench ICC 8.1 warning.
	* NEWS, README.html: Use netmask, not prefix length, in
	tcpd/hosts.allow example.  Reported by Gundemarie Scholz.

2004-09-30  Matthias Andree <matthias.andree@gmx.de>

	* texpire.c: Fix 'kept' counters in texpire -a mode. Reported by
	Robert Marshall.

2004-09-28  Matthias Andree <matthias.andree@gmx.de>

	* NEWS: Reformat version headers to Prereq: for patch would work.
	* texpire.8.in, texpire.c: Add texpire -a option to expire
	article-based rather than thread-based.

2004-09-20  Matthias Andree <matthias.andree@gmx.de>

	= snapshot 20040920a =
	* xoverutil.c: Initialize xfirst/xlast properly if running without
	fixxover flag.  Fixes XOVER and other trouble retrieving articles
	reported by Jack Raats and Robert Clark.

2004-09-16  Matthias Andree <matthias.andree@gmx.de>

	= snapshot 20040916a =
	* ChangeLog, NEWS, configure.ac: Snapshot 20040916a
	* xoverutil.c: Drop dead code, make rebuilding overview information
	optional for efficiency.
	* applyfilter.c, nntpd.c, texpire.c: Chase getxover() removal.
	* Makefile.am: Add new sgetcwd function.  Use cmp -s to avoid
	irritating cmp output during build.
	* leafnode.h: Add new sgetcwd function.  Drop getxover function.
	* sgetcwd.c, sgetcwd.h: Add new sgetcwd function.

2004-09-15  Matthias Andree <matthias.andree@gmx.de>

	= snapshot 20040915b =
	* configure.ac: Bump version.
	* CREDITS, NEWS, config.example, leafnode.8.in, nntputil.c: Bugfix:
	A timeout while connecting to a server (default 30 seconds) caused
	fetchnews to abort and print "Alarm clock." Reported by Michael
	Rulov.  Change: the fetchnews connect timeout now applies to each of
	the server's addresses.

2004-09-13  Matthias Andree <matthias.andree@gmx.de>

	* README.html: Mention debug info and that the file needs to be
	created.
	* texpire.c: Bugfix: legalxoverline() considered all overview lines
	broken, because it did not skip over the TAB before the Xref: header
	tag.

2004-09-12  Matthias Andree <matthias.andree@gmx.de>

	* NEWS, texpire.8.in: Update texpire man page.
	* texpire.8.in: Rewrite explanation for -f option. Suggested by
	Robert Marshall.

2004-09-01  Ralf Wildenhues <ralf.wildenhues@gmx.de>

	* configure.ac, fetchnews.c: configure.ac: add AC_PROG_CC_C_O to
	placate automake-1.9a.  fetchnews.c: fix format string bug.

2004-08-31  Matthias Andree <matthias.andree@gmx.de>

	* TODO: Update.

2004-08-23  Matthias Andree <matthias.andree@gmx.de>

	* CREDITS: Add Andreas Kneib for a good laugh.
	* ChangeLog, NEWS, configure.ac: 2.0.0.alpha20040823b

	= snapshot 20040823b =
	* fetchnews.c: Revert plausibility tests to not abort. Found by
	Jack Raats.

	= snapshot 20040823a =
	* NEWS: Clean up around timeout_delaybody.
	* NEWS, configure.ac: 20040823a
	* NEWS, config.example, config.table, configutil.c, fetchnews.c,
	leafnode.8.in, leafnode.h: Implement timeout_delaybody. Suggested
	by Cory C. Albrecht.
	* nntputil.c: Use server-specific timeout as timeout for connecting
	and reading the banner.
	* leafnode.8.in: document timeout_client
	* configutil.c: Consistent debug mode logging, all server-specific
	options now PREfixed with server name.
	* Makefile.am: Revise post-install message.

2004-08-22  Matthias Andree <matthias.andree@gmx.de>

	* NEWS, fetchnews.c: Quit from getgroup if only_group_pcre is set.
	Reported by Cory C. Albrecht.
	* NEWS, configutil.c: Cleanup ln_log -> ln_log_sys for
	LNLOG_SDEBUG, for consistency.
	* leafnode.8.in: Escape a backslash.
	* filterfile.5.in: Revise man page now that everything is a PCRE.
	Reported by JÃ¶rg LÃ¼ders.
	* fetchnews.8.in, leafnode.8.in: pcre(7) -> pcre(3)

2004-08-20  Matthias Andree <matthias.andree@gmx.de>

	* fetchnews.c:
	(getmarked) Diagnose write errors on the group.name file.
	(getmarked) Initialize failed-list early to avoid overhead
	(getmarked) Don't write the error message (getbymsgid clobbers l)
	but the real information.
	* configutil.c:
	(freeconfig) Free spooldir.

2004-08-19  Matthias Andree <matthias.andree@gmx.de>

	* fetchnews.c: Add diagnostics for fetching marked articles.
	* config.example, leafnode.8.in: Reword hostname documentation.
	* NEWS, fetchnews.c, nntpd.c: Expire interesting.group delaybody
	articles after time, not after 4 retries.
	* Makefile.am, expire_lookup.c, leafnode.h, texpire.c: Split
	lookup_expire into an own file.

2004-08-18  Matthias Andree <matthias.andree@gmx.de>

	* ChangeLog, NEWS, configure.ac: 2.0.0.alpha20040818a

	= snapshot 20040818a =
	* fetchnews.c: Handle old interesting.groups files without retry
	counter.
	* leafnode.h: Add COUNT_OF macro.
	* fetchnews.c: Handle retry count in interesting.groups files.  Fix
	FILE* clobber and double fclose on garbage at end of
	interesting.groups lines.
	* nntpd.c: Store a retry count of 0 into interesting.groups files
	for delaybody.
	* mastring.c, mastring.h: Add mastr_ncpy (untested).

2004-08-15  Matthias Andree <matthias.andree@gmx.de>

	* config.example, config.table, configutil.c, fetchnews.c,
	leafnode.8.in, leafnode.h: Forward port noread feature from
	leafnode-1.

2004-08-14  Matthias Andree <matthias.andree@gmx.de>

	* CHANGES-FROM-LEAFNODE-1, Makefile.am: Add CHANGES-FROM-LEAFNODE-1
	file

2004-08-13  Matthias Andree <matthias.andree@gmx.de>

	* nntpd.c:
	(fopenart) Log errors (other than ENOENT) when opening articles.
	(fopenart) Drop an if branch that is never executed.

	= snapshot 20040813a =
	* ChangeLog, NEWS, configure.ac: snapshot 20040813a
	* applyfilter.8.in, fetchnews.8.in, filterfile.5.in, leafnode.8.in,
	rnews.8.in, texpire.8.in: Fix path of $(sysconfdir) files. Reported
	by Cory C. Albrecht.

2004-07-22  Matthias Andree <matthias.andree@gmx.de>

	* TODO: high water mark issue

2004-07-06  Matthias Andree <matthias.andree@gmx.de>

	* fetchnews.c: Disable moving articles to failed.postings for now.
	* activutil.c, activutil.h, activutil_resolve.c, applyfilter.c,
	arc4random.c, artutil.c, b_sortnl.c, bsearch_range.c,
	cmp_firstcolumn.c, fetchnews.c, filterutil.c, getline.c,
	interesting.c, leafnode.h, link_force.c, localutil.c, lockfile.c,
	miscutil.c, nntpd.c, redblack.c, sort.c, store.c, strutil.c,
	t.mgetheader.c, xoverutil.c: Misc. minor fixes to the code is also
	valid C++.
	* Makefile.am: Suppress bogus error message.

2004-06-29  Matthias Andree <matthias.andree@gmx.de>

	* NEWS, texpire.c: Bugfix: restoring hard links didn't work for
	cross-posted articles.  Reported by Jeff Grossman.

2004-06-22  Matthias Andree <matthias.andree@gmx.de>

	* texpire.c: Cleanup: legalxover line no longer modifies the XOVER
	information.

2004-05-18  Matthias Andree <matthias.andree@gmx.de>

	* TODO: Note Andreas Kneib's suggestion.

2004-05-13  Matthias Andree <matthias.andree@gmx.de>

	= snapshot 20040513a =
	* fetchnews.c: Fix memory leak in postarticles when no active file
	is present.  Authenticate if GROUP command responds with 480.
	* fetchnews_check_date.c: check_date: fix logic bug/bogus "too few
	fields in DATE reply"
	* log_fchmod.c: log_fchmod: Revise log message.
	* activutil.c: mvactive: Fix memory leak.

2004-05-10  Matthias Andree <matthias.andree@gmx.de>

	= snapshot 20040510a =
	* configure.ac: Do not check for gethostbyaddr/-name, we don't use
	#ifdefs for these.  Bump version.
	* applyfilter.c: Don't segfault when article has no discernible
	Message-ID: header. Reported by Robert Marshall.
	* artutil.c: Include system.h
	* leafnode.h, system.h: Mark _GNU_SOURCE
	* leafnode.h: Fix splint comment.
	* Makefile.am: Add t.mgetheader.c.  Let rsync target work for VPATH
	builds.
	* configure.ac: Fed through autoupdate.
	* t.mgetheader.c: Add mgetheader check.
	* strcasestr.c: Add replacement strcasestr() function.
	* artutil.c: Bigfix: mgetheader: Use strcasestr, reported by Robert
	Marshall.
	* activutil.c, fetchnews_check_date.c: Cast is*() argument to
	unsigned char.
	* miscutil.c: Make ln_log argument and format string consistent.
	* nntpd.c: Revise PAM code, set PAM_RUSER and PAM_RHOST.
	* system.h: Add prototype for strcasestr.

2004-05-03  Matthias Andree <matthias.andree@gmx.de>

	* filters.example: Fix filterfile section, was 8, is now 5.
	Reported by Reiner Steib.

2004-03-29  Matthias Andree <matthias.andree@gmx.de>

	* midutil.c: Add a comment about Cygwin.

2004-03-27  Matthias Andree <matthias.andree@gmx.de>

	* Makefile.am, NEWS: Speed up installation: do not run chmod -R on
	spool automatically.

2004-03-26  Matthias Andree <matthias.andree@gmx.de>

	* ChangeLog, Makefile.am, NEWS, configure.ac: 2.0.0.alpha20040326a

	= snapshot 20040326a =
	* fetchnews.c: Drop too relaxed umask.
	* miscutil.c: Set minimum umask.
	* Makefile.am, activutil.c, checkgroups.c, fetchnews.c, leafnode.h,
	miscutil.c, nntpd.c: Change permission handling. No world
	permissions whatsoever.

2004-03-24  Matthias Andree <matthias.andree@gmx.de>

	* Makefile.am: Relax group permissions.
	* TODO: update
	* Makefile.am, miscutil.c: Relax group permissions.

2004-03-20  Matthias Andree <matthias.andree@gmx.de>

	* NEWS: mention stringlist change
	* NEWS, config.example: ln_log_stderronly is bogus, we use logstderr.
	Patch by Thomas Schwinge.

2004-03-19  Matthias Andree <matthias.andree@gmx.de>

	* ChangeLog, configure.ac: Snapshot 20040319a.

	= snapshot 20040319a = (withdrawn)
	* NEWS, nntpd.c: Fix SIGSEGV when XPAT, XHDR or NEWNEWS are issued
	without arguments.  slrn does such non-sense. Reported by Robert
	Grimm.

2004-03-14  Matthias Andree <matthias.andree@gmx.de>

	* NEWS: Correct the #include log.

2004-03-10  Matthias Andree <matthias.andree@gmx.de>

	* tools/lsmac.pl: Mention more explicitly that the file name's
	"mac" letters and the column ordering  do not match.

2004-03-05  Matthias Andree <matthias.andree@gmx.de>

	= snapshot 20040305a =
	* fetchnews.c: Running fetchnews with the -S switch would falsely
	file out.going articles into failed.postings. Bug found by Robert
	Marshall.

2004-03-04  Matthias Andree <matthias.andree@gmx.de>

	* TODO, fetchnews.c: Work around abort when the first server has
	"noactive" set.

2004-03-01  Ralf Wildenhues <ralf.wildenhues@gmx.de>

	* configure.ac, ugid_gset.c: Portability fix for linux: setgroups
	needs sys/types.h and grp.h.

2004-03-01  Matthias Andree <matthias.andree@gmx.de>

	* addpatches.pl, release.sh: Local, site-specific release helpers
	stored in CVS.
	* pam.d_leafnode: Sample file for PAM, not being shipped for it
	uses system accounts.

2004-02-28  Matthias Andree <matthias.andree@gmx.de>

	* configutil.c: Refuse to start when an unknown or unsupported
	authentication method is configured.

2004-02-27  Matthias Andree <matthias.andree@gmx.de>

	* CREDITS: Credit Hynek.
	* ChangeLog, NEWS, README.html, configure.ac: snapshot 20040227a.

	= snapshot 20040227a =
	* leafnode.h, leafnode-2/leafnode.h: Fix incomplete type in
	stringlistnode, for C89 compatibility.  Support PAM, based on
	Hynek's patch, with modifications and documentation added.
	* config.example, configure.ac, configutil.c, leafnode.8.in,
	nntpd.c, leafnode-2/config.example, leafnode-2/configure.ac,
	leafnode-2/configutil.c, leafnode-2/leafnode.8.in,
	leafnode-2/nntpd.c: Import PAM, based on Hynek's patch, with
	modifications and documentation added.
	* genconfigdefs.awk, leafnode-2/genconfigdefs.awk: Suppress
	trailing comma.
	* ugid_gset.c, leafnode-2/ugid_gset.c: Clear supplementary group
	IDs.

2004-02-26  Matthias Andree <matthias.andree@gmx.de>

	* ChangeLog, leafnode-2/ChangeLog: update
	* fetchnews.c, leafnode-2/fetchnews.c: getaline -> mgetaline for
	all NNTP-related reads, to fix undetected timeouts.  rename
	_ignore_answer to ignore_answer.

2004-02-18  Matthias Andree <matthias.andree@gmx.de>

	* TODO, leafnode-2/TODO: Clarify two items after preliminary
	discussion with Jörg Dietrich. Subject to further change!

2004-02-17  Matthias Andree <matthias.andree@gmx.de>

	* .cvsignore, leafnode-2/.cvsignore: Add semantic.cache per hynek's
	request.
	* NEWS, leafnode-2/NEWS: update
	* ChangeLog, leafnode-2/ChangeLog: update
	* TODO: posting vs. approved
	* fetchnews.c, grouplist.c, grouplist.h, leafnode.h, miscutil.c,
	nntpd.c, texpire.c: Stringlist reformation patch. stringlists now
	use a sentinel element as first (head) and last (tail) element.
	Bugfix: -M will now be able to try the same Message-ID on more than
	one server (reported by Daniel Zwick).  Feature: Unfetched articles
	from -M options are now logged at the end of the run.

2004-02-16  Matthias Andree <matthias.andree@gmx.de>

	* Makefile.am: Use grouplist test program.

2004-02-10  Matthias Andree <matthias.andree@gmx.de>

	* TODO: crossposts into local groups should be prohibited
	* TODO: Clarify Ivo Schwalbe's article loss bug.
	* TODO: Mark Ivo Schwalbe's article loss bug fixed without further
	tests. (hynek)
	* xoverutil.c: Remove 'cannot lstat' message after 'removing empty
	article file'. Reported by Martin Imlau.

2004-02-09  Matthias Andree <matthias.andree@gmx.de>

	* leafnode-version.c: Print PCRE version.

2004-02-08  Matthias Andree <matthias.andree@gmx.de>

	* fetchnews_check_date.c, filterutil.c, nntpd.c: Kill more static
	forward declarations.
	* activutil.c, rnews.c: Kill unneeded static decl's.
	* miscutil.c: Shuffle code around to eliminate static forward
	decl's.
	* nntpd.c: Eliminate static forward declarations. Make some
	internal functions static.
	* texpire.c: Unexport internal functions.  Rearrange code to
	eliminate forward declarations of internal functions.
	* fetchnews.c: Rearrange code to get rid of forward declarations
	for static functions.
	* TODO, activutil.c, fetchnews_check_date.c: Elimination of all
	sscanf(), courtesy of Hynek Schlawack.

2004-02-06  Matthias Andree <matthias.andree@gmx.de>

	* ChangeLog, NEWS, configure.ac: snapshot 20040206a

	= snapshot 20040206a =
	* newsq.c: Print whether an article has successfully been posted.
	* fetchnews.c:
	* Mark successfully posted articles with S_IXUSR mode to suppress
	warnings or moving into failed.postings.
	* Move all non-S_IXUSR articles into failed.postings after a run in
	which all servers have successfully been contacted.
	* Fix -S option, broken since leafnode-2-0-0-alpha20040116a. Allows
	to drop some functions.
	* Format string signedness fixes.
	* configure.ac: Support ICC, ignoring AC_FUNC_SETVBUF_REVERSED
	check.
	* ln_log.c, ln_log.h: move "verbose" import into header file.
	* xoverutil.c: Kill dead code. Fix printf format string signedness.
	* texpire.c: Kill dead code. Cast time_t to long before printf.
	* applyfilter.c, miscutil.c, nntpd.c, nntputil.c: Kill dead code.
	* Makefile.am: #include "leafnode.h" in config.c
	* configure.ac: Add -Wsequence-point -Wswitch -Wunused
	-Wuninitialized -Wundef to GCC warning options.

2004-02-05  Matthias Andree <matthias.andree@gmx.de>

	* xoverutil.c: Obtain Bytes: and Lines: from header and from file
	and take whichever is larger, to support delaybody.
	* miscutil.c: Sanity check spooldir option, expect leaf.node
	subdir.

2004-01-31  Matthias Andree <matthias.andree@gmx.de>

	* ChangeLog, ChangeLog-2003: Split ChangeLog into two files.
	* miscutil.c: Drop extraneous prototype.
	* strutil.c: Drop cruft from TEST body.
	* interesting.c: Drop unused variable now.
	* fetchnews.c: Degrade 'Wrong reply to ARTICLE command' from error
	to notice.
	* xoverutil.c: Drop extraneous declarations.
	* leafnode.h: Clean up, add prototype for writexover.
	* getline.c: Drop prototype, belongs into header.
	* activutil.c: Don't use %lu to sscanf into time_t. Scan into
	unsigned long and then assign. Quiets compiler warning.

2004-01-29  Matthias Andree <matthias.andree@gmx.de>

	* Makefile.am, strutil.c: Fix strutil test mode.
	* draft-ietf-nntpext-base-15.txt: Drop IETF draft.
	* ChangeLog, NEWS, configure.ac: snapshot 20040129a "Sticky Snow"

	= snapshot 20040129a =
	* NEWS, TODO, config.example, config.table, configutil.c,
	fetchnews.c, leafnode.8.in, leafnode.h: Forward port "noactive"
	option from leafnode 1.9.  Drop support for "supplement" option. Use
	"server" instead.

2004-01-28  Matthias Andree <matthias.andree@gmx.de>

	* applyfilter.8.in: Change formatting.
	* applyfilter.8.in: Note that -C mode is local only and does not
	create control messages.

2004-01-27  Matthias Andree <matthias.andree@gmx.de>

	* README-leaf.node: Mention SERVER/SERVER:PORT's mtime used for
	NEWGROUPS.
	* Makefile.am, README-leaf.node, leafnode.spec.in: README-leaf.node
	describes the contents of the leaf.node directory.
	* fetchnews.c: Robustness: Make leaf.node/server[:port]~ files line
	buffered, in order to recover more data in a hard crash.
	* nntpd.c: Use mysetvbuf.
	* Makefile.am, mysetvbuf.c, mysetvbuf.h: New mysetvbuf(). Wrapper
	for setvbuf that handles reversed arguments.
	* tools/lsmac.pl: Add -d option and allow to give files as
	arguments.

2004-01-22  Matthias Andree <matthias.andree@gmx.de>

	* NEWS, newsq.1.in, newsq.c: New newsq -c option that sets its exit
	code depending on whether there are articles spooled in out.going.
	* ChangeLog, NEWS, configure.ac: snapshot 2.0.0.alpha20040122a

	= snapshot 20040122a =
	* NEWS, applyfilter.8.in, applyfilter.c: Add applyfilter -C option
	to cancel message-IDs on command line.
	* artutil.c: document angle brackets requirement for message-id
	passed to delete_article.
	* nntputil.c: Do not log TCP send buffer size. Useless.

2004-01-19  Matthias Andree <matthias.andree@gmx.de>

	* ChangeLog, NEWS, configure.ac: Snapshot 20040119a.

	= snapshot 20040119a =
	* leafnode-version.c: Fix up the spooldir/lockfile changes that
	caused a segfault.

2004-01-18  Matthias Andree <matthias.andree@gmx.de>

	* Makefile.am: Make sure bindir and sysconfdir aren't empty.

2004-01-17  Matthias Andree <matthias.andree@gmx.de>

	* leafnode.spec.in:
	 List uucp and sendbatch.bash in %files. Reported by Daniel Zwick.
	* configure.ac: Clean up sysconfdir handling. Add GCC flags to
	CFLAGS.
	* Makefile.am: Clean up.

2004-01-16  Matthias Andree <matthias.andree@gmx.de>

	* leafnode.spec.in: Update.
	* ChangeLog, NEWS, configure.ac: Release 20040116a.

	= snapshot 20040116a =
	* Makefile.am, genconfigdefs.awk, genconfigparam_data.awk: Makefile
	cleanup. Do not ship AWK-generated files.
	* b_sortnl.c: Quench compiler warnings in SPARC64.
	* critmem_realloc.c: Add missing variable declaration.
	* Makefile.am, b_sortnl.c, configure.ac, critmem_calloc.c,
	critmem_malloc.c, critmem_realloc.c, malloc.c, realloc.c,
	xoverutil.c: Get rid of rpl_malloc and rpl_realloc cruft.
	* Makefile.am: Do not ship config.c.
	* tools/Makefile.am: Unwedge VPATH build.
	* tools/Makefile.am: Make pod2man non-GNU make friendly.
	* fetchnews.c: Read filterfile earlier, to support paths relative
	to cwd.
	* .cvsignore: add generated file.
	* nntpd.c: Do not leak configuration file location into error
	message.
	* .cvsignore: add filterutil, grouplist
	* minconfig, minfilter: Add minconfig/minfilter for testing
	purposes.
	* nntpd.c, texpire.c: Update initialization.
	* rnews.c: Initialize properly to support -d option.  Read
	filterfile before trying to lock, because attempt_lock() calls
	chdir(). The filterfile might be relative in a minimal test suite
	configuration.
	* newsq.c: Initialize properly to support -d spooldir option.
	* miscutil.c: Split initialization into initvars() and init_post().
	Add new init_failed() function that prints to stderr and exits.
	Drop #ifdef TESTMODE.  Add global variables spooldir and lockfile,
	both char *.  Only drop permissions when root, to let a user use his
	own -d. In preparation of a test suite.  Drop findopt and getoptarg
	cruft, it's not needed for fetchnews any longer.  Support global
	option "-d".
	* fetchnews.c: Bugfix -F option.  Avoid "non-literal format"
	warning (the code was safe, no % could be in the string) when
	printing fetchnews mode, insert "%s".  Initialization updates.
	* checkgroups.c: Use the right file in presence of options.
	Initialize properly to support -d and -F options.  Drop the explicit
	access check, removing a race condition.
	* applyfilter.c: Split initialization, minor clean-ups.
	* lockfile.c: Rename lockfile_exists to attempt_lock.
	* activutil.c, config.table, configutil.c, localutil.c:
	local.groups location now run-time configurable.
	* leafnode.h: Prepare split of initialization and run-time
	configuration of spooldir.  lockfile is derived from spooldir in
	initialization, make non-const.  Rename lockfile_exists to
	attempt_lock.
	* configure.ac: Drop LOCKFILE.
	* Makefile.am: Drop lockfile. Rename config.c's spooldir to
	def_spooldir.
	* ln_log.c, ln_log_open.c: Drop #ifdef TESTMODE.

2004-01-14  Matthias Andree <matthias.andree@gmx.de>

	* nntpd.c: LIST NEWSGROUPS/LIST ACTIVE crashed (NULL dereference)
	when a non-wildcard pattern requested a non-existent group.  Patch
	by Hans-Jürgen Ficker.

2004-01-13  Ralf Wildenhues <ralf.wildenhues@gmx.de>

	* configure.ac: Fix bogus check, adding CFLAGS and LDFLAGS for pcre
	whenever pcre-config returns nonempty flags.  Former grep would most
	likely complain because of argument starting with '-'.

2004-01-08  Matthias Andree <matthias.andree@gmx.de>

	* ChangeLog, NEWS, configure.ac: snapshot 20040108a

	= snapshot 20040108a =
	* fetchnews.c: Log user name when authentication fails.  Patch by
	Samuel Tardieu.

2004-01-06  Matthias Andree <matthias.andree@gmx.de>

	* try-indent.c.orig: Remove unneeded file.
	* reformat.pl: Handle new --version output of GNU indent 2.2.8a.

2004-01-05  Matthias Andree <matthias.andree@gmx.de>

	* leafnode.8.in: Document log_poster_ip. Patch by Samuel Tardieu.
	* nntpd.c: Clean up code a bit, avoid double maock_sa2addr for
	log_sockaddr.
	* config.example, config.table, configutil.c, leafnode.h, nntpd.c:
	Support a new log_poster_ip option that inserts a
	X-Leafnode-NNTP-Posting-Host header. Based on a patch by Samuel
	Tardieu, nntpd.c with modifications.
	* configure.ac: Enhance ./configure --help messages.  Patch by
	Samuel Tardieu.
	* nntputil.c: Log authentication failures with username and server.
	Patch by Samuel Tardieu <sam@rfc1149.net>.

THE REST OF THIS ChangeLog was split into ChangeLog-2003
