2004-02-06  Matthias Andree <matthias.andree@gmx.de>

	= snapshot 20040206a =
	* newsq.c: Print whether an article has successfully been posted.
	* fetchnews.c:
	* Mark successfully posted articles with S_IXUSR mode to suppress
	warnings or moving into failed.postings.
	* Move all non-S_IXUSR articles into failed.postings after a run in
	which all servers have successfully been contacted.
	* Fix -S option, broken since leafnode-2-0-0-alpha20040116a. Allows
	to drop some functions.
	* Format string signedness fixes.
	* configure.ac: Support ICC, ignoring AC_FUNC_SETVBUF_REVERSED
	check.
	* ln_log.c, ln_log.h: move "verbose" import into header file.
	* xoverutil.c: Kill dead code. Fix printf format string signedness.
	* texpire.c: Kill dead code. Cast time_t to long before printf.
	* applyfilter.c, miscutil.c, nntpd.c, nntputil.c: Kill dead code.
	* Makefile.am: #include "leafnode.h" in config.c
	* configure.ac: Add -Wsequence-point -Wswitch -Wunused
	-Wuninitialized -Wundef to GCC warning options.

2004-02-05  Matthias Andree <matthias.andree@gmx.de>

	* xoverutil.c: Obtain Bytes: and Lines: from header and from file
	and take whichever is larger, to support delaybody.
	* miscutil.c: Sanity check spooldir option, expect leaf.node
	subdir.

2004-01-31  Matthias Andree <matthias.andree@gmx.de>

	* ChangeLog, ChangeLog-2003: Split ChangeLog into two files.
	* miscutil.c: Drop extraneous prototype.
	* strutil.c: Drop cruft from TEST body.
	* interesting.c: Drop unused variable now.
	* fetchnews.c: Degrade 'Wrong reply to ARTICLE command' from error
	to notice.
	* xoverutil.c: Drop extraneous declarations.
	* leafnode.h: Clean up, add prototype for writexover.
	* getline.c: Drop prototype, belongs into header.
	* activutil.c: Don't use %lu to sscanf into time_t. Scan into
	unsigned long and then assign. Quiets compiler warning.

2004-01-29  Matthias Andree <matthias.andree@gmx.de>

	* Makefile.am, strutil.c: Fix strutil test mode.
	* draft-ietf-nntpext-base-15.txt: Drop IETF draft.
	* ChangeLog, NEWS, configure.ac: snapshot 20040129a "Sticky Snow"

	= snapshot 20040129a =
	* NEWS, TODO, config.example, config.table, configutil.c,
	fetchnews.c, leafnode.8.in, leafnode.h: Forward port "noactive"
	option from leafnode 1.9.  Drop support for "supplement" option. Use
	"server" instead.

2004-01-28  Matthias Andree <matthias.andree@gmx.de>

	* applyfilter.8.in: Change formatting.
	* applyfilter.8.in: Note that -C mode is local only and does not
	create control messages.

2004-01-27  Matthias Andree <matthias.andree@gmx.de>

	* README-leaf.node: Mention SERVER/SERVER:PORT's mtime used for
	NEWGROUPS.
	* Makefile.am, README-leaf.node, leafnode.spec.in: README-leaf.node
	describes the contents of the leaf.node directory.
	* fetchnews.c: Robustness: Make leaf.node/server[:port]~ files line
	buffered, in order to recover more data in a hard crash.
	* nntpd.c: Use mysetvbuf.
	* Makefile.am, mysetvbuf.c, mysetvbuf.h: New mysetvbuf(). Wrapper
	for setvbuf that handles reversed arguments.
	* tools/lsmac.pl: Add -d option and allow to give files as
	arguments.

2004-01-22  Matthias Andree <matthias.andree@gmx.de>

	* NEWS, newsq.1.in, newsq.c: New newsq -c option that sets its exit
	code depending on whether there are articles spooled in out.going.
	* ChangeLog, NEWS, configure.ac: snapshot 2.0.0.alpha20040122a

	= snapshot 20040122a =
	* NEWS, applyfilter.8.in, applyfilter.c: Add applyfilter -C option
	to cancel message-IDs on command line.
	* artutil.c: document angle brackets requirement for message-id
	passed to delete_article.
	* nntputil.c: Do not log TCP send buffer size. Useless.

2004-01-19  Matthias Andree <matthias.andree@gmx.de>

	* ChangeLog, NEWS, configure.ac: Snapshot 20040119a.

	= snapshot 20040119a =
	* leafnode-version.c: Fix up the spooldir/lockfile changes that
	caused a segfault.

2004-01-18  Matthias Andree <matthias.andree@gmx.de>

	* Makefile.am: Make sure bindir and sysconfdir aren't empty.

2004-01-17  Matthias Andree <matthias.andree@gmx.de>

	* leafnode.spec.in:
	 List uucp and sendbatch.bash in %files. Reported by Daniel Zwick.
	* configure.ac: Clean up sysconfdir handling. Add GCC flags to
	CFLAGS.
	* Makefile.am: Clean up.

2004-01-16  Matthias Andree <matthias.andree@gmx.de>

	* leafnode.spec.in: Update.
	* ChangeLog, NEWS, configure.ac: Release 20040116a.

	= snapshot 20040116a =
	* Makefile.am, genconfigdefs.awk, genconfigparam_data.awk: Makefile
	cleanup. Do not ship AWK-generated files.
	* b_sortnl.c: Quench compiler warnings in SPARC64.
	* critmem_realloc.c: Add missing variable declaration.
	* Makefile.am, b_sortnl.c, configure.ac, critmem_calloc.c,
	critmem_malloc.c, critmem_realloc.c, malloc.c, realloc.c,
	xoverutil.c: Get rid of rpl_malloc and rpl_realloc cruft.
	* Makefile.am: Do not ship config.c.
	* tools/Makefile.am: Unwedge VPATH build.
	* tools/Makefile.am: Make pod2man non-GNU make friendly.
	* fetchnews.c: Read filterfile earlier, to support paths relative
	to cwd.
	* .cvsignore: add generated file.
	* nntpd.c: Do not leak configuration file location into error
	message.
	* .cvsignore: add filterutil, grouplist
	* minconfig, minfilter: Add minconfig/minfilter for testing
	purposes.
	* nntpd.c, texpire.c: Update initialization.
	* rnews.c: Initialize properly to support -d option.  Read
	filterfile before trying to lock, because attempt_lock() calls
	chdir(). The filterfile might be relative in a minimal test suite
	configuration.
	* newsq.c: Initialize properly to support -d spooldir option.
	* miscutil.c: Split initialization into initvars() and init_post().
	Add new init_failed() function that prints to stderr and exits.
	Drop #ifdef TESTMODE.  Add global variables spooldir and lockfile,
	both char *.  Only drop permissions when root, to let a user use his
	own -d. In preparation of a test suite.  Drop findopt and getoptarg
	cruft, it's not needed for fetchnews any longer.  Support global
	option "-d".
	* fetchnews.c: Bugfix -F option.  Avoid "non-literal format"
	warning (the code was safe, no % could be in the string) when
	printing fetchnews mode, insert "%s".  Initialization updates.
	* checkgroups.c: Use the right file in presence of options.
	Initialize properly to support -d and -F options.  Drop the explicit
	access check, removing a race condition.
	* applyfilter.c: Split initialization, minor clean-ups.
	* lockfile.c: Rename lockfile_exists to attempt_lock.
	* activutil.c, config.table, configutil.c, localutil.c:
	local.groups location now run-time configurable.
	* leafnode.h: Prepare split of initialization and run-time
	configuration of spooldir.  lockfile is derived from spooldir in
	initialization, make non-const.  Rename lockfile_exists to
	attempt_lock.
	* configure.ac: Drop LOCKFILE.
	* Makefile.am: Drop lockfile. Rename config.c's spooldir to
	def_spooldir.
	* ln_log.c, ln_log_open.c: Drop #ifdef TESTMODE.

2004-01-14  Matthias Andree <matthias.andree@gmx.de>

	* nntpd.c: LIST NEWSGROUPS/LIST ACTIVE crashed (NULL dereference)
	when a non-wildcard pattern requested a non-existent group.  Patch
	by Hans-Jürgen Ficker.

2004-01-13  Ralf Wildenhues <ralf.wildenhues@gmx.de>

	* configure.ac: Fix bogus check, adding CFLAGS and LDFLAGS for pcre
	whenever pcre-config returns nonempty flags.  Former grep would most
	likely complain because of argument starting with '-'.

2004-01-08  Matthias Andree <matthias.andree@gmx.de>

	* ChangeLog, NEWS, configure.ac: snapshot 20040108a

	= snapshot 20040108a =
	* fetchnews.c: Log user name when authentication fails.  Patch by
	Samuel Tardieu.

2004-01-06  Matthias Andree <matthias.andree@gmx.de>

	* try-indent.c.orig: Remove unneeded file.
	* reformat.pl: Handle new --version output of GNU indent 2.2.8a.

2004-01-05  Matthias Andree <matthias.andree@gmx.de>

	* leafnode.8.in: Document log_poster_ip. Patch by Samuel Tardieu.
	* nntpd.c: Clean up code a bit, avoid double maock_sa2addr for
	log_sockaddr.
	* config.example, config.table, configutil.c, leafnode.h, nntpd.c:
	Support a new log_poster_ip option that inserts a
	X-Leafnode-NNTP-Posting-Host header. Based on a patch by Samuel
	Tardieu, nntpd.c with modifications.
	* configure.ac: Enhance ./configure --help messages.  Patch by
	Samuel Tardieu.
	* nntputil.c: Log authentication failures with username and server.
	Patch by Samuel Tardieu <sam@rfc1149.net>.

THE REST OF THIS ChangeLog was split into ChangeLog-2003
