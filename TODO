-*- mode: text; coding: iso-8859-1; -*-
 ----------------------------------------------------------------------
		   Leafnode 2.0b8_ma branch TODO list
 ----------------------------------------------------------------------


NOTE: issues fixes in the current, possibly unreleased _ma versions, but
persistent in the offical 2.0b tree, are not listed here.

STATE: NEW -> OPEN -> ANALYZED -> NEEDFEEDBACK|RESOLVED|REJECTED

This is a PRIORITIZED LIST. It has two columns, first the importance,
second the urgence. (Matthias)

importance:
1 = most important, 5 = forget it
urgence:
1 = do now, 5 = postpone until bored

"security relevant": at most 2.2

"works correctly, but suboptimal": importance and urgence at least 3.3

0.0 use separate repairspool program

1.1 Robert Marshall on 2.0b8_ma9:
    Changing subject slightly, I have a filters file containing
    newsgroups = *
    maxcrosspost = 6
    action = kill
    and I've just seen an article crossposted to 8 groups...

1.1 fix posting issues, introduce per-server queues?

1.1 out.going: "Nur, wenn ich fetchnews aufrufe, ohne Online zu
    sein, geht das Posting verschütt. Ohne Fehlermeldung." Ivo Schwalbe,
    <51nig9.kv.ln@abu.ivos.de>
    NOTE: only worked around, not fixed.
    TODO: only delete articles successfully posted

1.1 tin claims "no articles" for all local groups.
    IN: 2002-01-06
    FROM: Lutz Frommberger, 2002-01-06. Private mail, ID:
	  <E16MzOy-0000An-00@dali.aufgebot.gov>
    STATE: NEW

1.1 groupinfo not updated after timeout + subsequent SIGINT
    bug confirmed by Jörg Dietrich 2002-01-04
    ACTION: fix

2.2 insertgroups/mergegroups global/static variables suck big time

2.2 for posts to moderated groups, add server preferences for posting?

2.2 track which user posted an article (Stefan Fleiter)

2.2 make user that leafnode runs under (now hard-wired to "news") configurable

2.2 also run feedincoming on exit of programs that lock (after they free
    the lock)

2.2 do not store cancel and perhaps other control messages locally?

2.2 cancelwatch

2.2 heed Expires: header in texpire

2.2 log RFC931 or AUTH data who posted an article (maybe show in newsq)

2.2 Check RPM build

2.2 pipeline GROUP commands for speed (make configurable for
    compatiblity with old server: separate parameter from ARTICLE
    pipeline)?

2.2 Create rpost/inews

2.2 Fix and amend copyright statements and licenses.

2.2 groupinfo is not updated for local groups (article low/high marks)
    when these are reinserted.

2.2 strings returned by {f,m,}getheader must be freed (Stefan Wiens)
    ACTION: work in progress.
    FIX: Use garbage collector instead?

2.2 nntpd control articles are also displayed

2.2 tolerate ", " instead of just "," in Newsgroup:
    current NNTP drafts suggests that to be able to fold Newsgroup: headers.
    ACTION: work in progress, fixed in some places.

2.2 convert Newsgroup: to lowercase on external newsgroups.

2.2 option to freeze interesting.groups as it is -- just give away group
    permissions to root -- Ozz 2001-06-12

2.2 "rnews does not work in pipes", Jörg Dietrich, Raymond Scholz,
    <3AF40BA6.BeroList-2.5.9@wpxx02.toxi.uni-wuerzburg.de>
    See 0.0 above as well.

2.3 "Das ist eine Macke von Leafnode. Wird von einem Server die
    komplette Gruppenliste geholt, so werden neu hinzugekommene Gruppen
    bei NEWGROUPS nicht aufgeführt. Der Reader findet sie daher nicht
    ohne weiteres." (Stefan Wiens, de.comm.software.newsserver
    2000-12-07, Message-ID: <wkr93lxerw.fsf@helium.eswe.dyndns.org>)
    Transl: if a complete group list is fetched from a server, newly
    appeared groups are not offered in NEWGROUPS.
    ACTION: fix.
    Idea #1: Possibly emit list from mergegroups
    Idea #2: diff newsgroups list before and after group list fetch
    Idea #3: Store newsgroups in timestamped file.

2.3 if XHDR and XOVER fail, fall back to HEAD!
    ACTION: implement HEAD

3.3 rnews is currently deactivated. Work in progress. Will have to
    reintroduce rnews and find a way to feed news batches to UUCP mode
    upstream

3.3 does not send UUCP to upstream, introduce option to batch and spool
    UUCP

3.3 Ben Holmes: enable clients to read newsgroups immediately after
    completion of their download, rather than only after fetchnews
    completed.

3.3 add support for stderr logging so that multilog can be used
    (clemensF <rabat@web.de>).

3.3 add IHAVE support for feeding upstream

3.3 Suggestion by Jörg Mensmann: only pick groups from supplement that
    have not been fetched before (or filter groups by server)

3.3 don't supersede() articles unconditionally
    ACTION: figure criteria for allowing/denying supersede
    Cancel-Lock? Plausibility checks?

3.3 authentication interface:
    make PAM aware (Solaris, Linux, FreeBSD) to get rid of crypt?
    Use Bruce Günter's credential validation module?

3.3 ACLs (possibly including identd) or regexp to prevent groups from
    being shown (mind ARTICLE <message@id> and check against Xref or
    Newsgroups: headers)

3.3 ACLs (possibly including identd) or regexp to filter which groups
    may be subscribed to (could include user specific)

3.3 clean up fetchnews main function, it's a horrible mess with all
    those !postonly, unmaintainable.

3.3 Hook (ext. program) for editing group info,
    <slrn9e1dv6.3il.wum@wum.truhaso.lu> and
    <m3snj2d3k1.fsf@emma1.emma.line.org>

3.3 run everything through various static and dynamic checkers
    (efence, dmalloc, lclint)

3.3 get rid of _all_ sscanf (Matthias Andree)

3.3 how to make newsgroup names 8-bit compliant? E.g., how to produce
    a newsgroups line of the form
	Newsgroups: norge.østfold
    Some readers encode this as ISO-8859-1 but this apparently is not
    understood upstream. It is also against the RFCs. son-of-rfc1036
    says that all data must be transmitted with ASCII < 127.
    draft-ietf-nntpext-base-07.txt says that the character set for all
    NNTP commands is UTF-8 (unicode!). Another possible draft is
    draft-ietf-usefor-article-01.txt (chapter 5.5.) which is not very
    helpful either.

3.3 fetchnews starts with an initialfetch (!)

3.3 let texpire use the actual article date rather than mtime/atime

3.3 send posted articles out immediately -- based on switches or
    filters? MID <3C10FC04.BeroList-2.5.9@wpxx02.toxi.uni-wuerzburg.de>?
    Ben Holness.

3.4 postarticles is a horrible mess. It deletes the articles IMMEDIATELY
    if it's available on a server.

4.2 get rid of all those if (verbose > anything)

4.3 move old articles from out.going to failed.postings if they are,
    say, 7 days, old? (Report by Stefan Wiens, Message-ID:
    <3A1EDBFF.BeroList-2.5.9@wpxx02.toxi.uni-wuerzburg.de>)

4.4 NOCEM, store Message-ID in advance (advance cancel, nocem, ...)
    (Mike Castle, dalgoda@ix.netcom.com)

4.4 implement detection if local group shadows server group

4.4 can fetchnews cope with servers that reject XOVER? (Matthias Andree)

4.4 server dependent out.going, possibly a repost command?

4.4 interrupt fetch every 100 (configurable) postings and then
    reconnect, to beat the INN configuration option.

4.4 see if the dots that NNTP servers escape can remain in the articles
    so that the body can be passed through to the client 1:1 (would need
    review if CR is required, and would break "direct spool" operation)

4.4 progress displays on terminals for fetchnews and texpire

4.4 optionally forbid crosspostings to local and global groups.
    (consider this for local posts and check whether to ignore this for
    downstream pulled articles)

4.4 split post functionality from fetchnews to a separate daemon (but
    maybe call the new daemon automatically) Ozz 2001-06-12

5.5 getgroup: "%s: considering %ld articles %lu - %lu" does not include
    proper article count as sent by server, but just uses last-first+1

5.5 delaybody only for certain groups?

5.5 introduce Control: pseudo group functionality

5.5 abort group fetch and proceed to next group

========================================================================
FIXED ITEMS:

2002-02-04 leafnode may store newly fetched articles into the gaps if groupinfo
           is not current. groupinfo may be out of date after a crash, fix
           watermarks.

2002-02-04 put conditional #include <dmalloc.h> into each file

2002-02-03 do not log without debug/verbose mode (cron should not send mail
	   when everything goes smoothly)

2002-01-07 1.1 article can be given out in spite of missing message.id
           file - a missing message.id file/link hints to spool
           corruption. store() does NOT link into message.id on write
           errors.

2002-01-07 .overview must always be more current than groupinfo, so that
           nntpd never offers article via GROUP that it cannot provide
           via XOVER e. g. (Stefan Wiens)

2002-01-06 authinfo handling in nntpd.c proper? (just user gives ACCEPT)
	   ACTION: replace by proper state machine

2002-01-06 document NOPOSTING env variable that prevents posting

2002-01-06 NOPOSTING: replace the banner with the contents of this
	   variable.

2002-01-06 Fix nntputil.c and nntpd.c for proper IPv6
	   (getipnodebyname/byaddr etc.)

2002-01-06 groupinfo is all 0 0 0 if groupinfo is entirely re-read, until
	   texpire is run.

========================================================================
DROPPED ITEMS:

2002-01-06 report Raymond Scholz, rnews doesn't read from pipes.
           ACTION: reimplement rnews from scratch.
	   (duplicate report, merged with Jörg Dietrich's)

2002-01-06 gethostbyname is not subject to timeout control
	   (rely on the OS to do that)

2002-01-06 signal needs to be worked around on Solaris 7 (Matthias Andree)
	   (I no longer care for goofed Solaris includes as long as the
	   stuff still works properly.)

2002-01-06 determine interesting groups from .newsrc
	   (.newsrc format is not consistent; layer violation)
